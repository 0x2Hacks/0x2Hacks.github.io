{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.statusFromToken = exports.resetState = void 0;\n\nconst types_1 = require(\"../types\"); // eslint-disable-next-line import/prefer-default-export\n\n\nconst resetState = state => Object.assign(Object.assign({}, state), {\n  gatewayStatus: types_1.GatewayStatus.UNKNOWN,\n  tokenRequested: false,\n  iframeMinimized: false,\n  firstTokenCheck: true,\n  renderIframe: false,\n  gatewayToken: undefined,\n  powoRequested: undefined,\n  refreshTimeoutId: undefined,\n  powoFinished: false,\n  refreshInProgress: false,\n  tokenIssuanceState: types_1.TokenIssuanceState.NOT_REQUESTED,\n  walletToRefresh: undefined,\n  walletPowoInProgress: false,\n  gatekeeperRecordState: undefined,\n  civicPass: {\n    status: types_1.CivicPassIssuanceStatus.NOT_REQUESTED,\n    iframeMinimized: false,\n    renderIframe: false\n  }\n});\n\nexports.resetState = resetState;\n\nconst hasExpired = gatewayToken => {\n  const now = Math.floor(Date.now() / 1000);\n  return !!gatewayToken.expiryTime && now >= gatewayToken.expiryTime;\n};\n\nconst isLocationNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperAPIStatus.LOCATION_NOT_SUPPORTED].includes(recordState);\n};\n\nconst isIssuedLocationNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperAPIStatus.ISSUED_LOCATION_NOT_SUPPORTED].includes(recordState);\n};\n\nconst isIssuedVpnNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperAPIStatus.ISSUED_VPN_NOT_SUPPORTED].includes(recordState);\n};\n\nconst isVpnNotSupported = recordState => {\n  if (!recordState) return false;\n  return [types_1.GatekeeperAPIStatus.VPN_NOT_SUPPORTED].includes(recordState);\n};\n\nconst statusFromToken = (state, gatewayToken) => {\n  if (!gatewayToken) return state.gatewayStatus;\n\n  switch (gatewayToken.state) {\n    case types_1.State.ACTIVE:\n      if (isLocationNotSupported(state.gatekeeperRecordState)) {\n        return types_1.GatewayStatus.LOCATION_NOT_SUPPORTED;\n      }\n\n      if (isVpnNotSupported(state.gatekeeperRecordState) || isIssuedVpnNotSupported(state.gatekeeperRecordState)) {\n        return types_1.GatewayStatus.VPN_NOT_SUPPORTED;\n      }\n\n      if (isIssuedLocationNotSupported(state.gatekeeperRecordState)) {\n        return types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED;\n      }\n\n      if (state.gatewayStatus === types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP) {\n        return types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP;\n      }\n\n      return hasExpired(gatewayToken) ? types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED : types_1.GatewayStatus.ACTIVE;\n\n    case types_1.State.REVOKED:\n      return types_1.GatewayStatus.REVOKED;\n\n    case types_1.State.FROZEN:\n      return types_1.GatewayStatus.FROZEN;\n\n    default:\n      return types_1.GatewayStatus.UNKNOWN;\n  }\n};\n\nexports.statusFromToken = statusFromToken;","map":{"version":3,"sources":["/workspace/0x2Hacks.github.io/candy-machine-ui/node_modules/@civic/common-gateway-react/dist/esm/useReducer/utils.js"],"names":["Object","defineProperty","exports","value","statusFromToken","resetState","types_1","require","state","assign","gatewayStatus","GatewayStatus","UNKNOWN","tokenRequested","iframeMinimized","firstTokenCheck","renderIframe","gatewayToken","undefined","powoRequested","refreshTimeoutId","powoFinished","refreshInProgress","tokenIssuanceState","TokenIssuanceState","NOT_REQUESTED","walletToRefresh","walletPowoInProgress","gatekeeperRecordState","civicPass","status","CivicPassIssuanceStatus","hasExpired","now","Math","floor","Date","expiryTime","isLocationNotSupported","recordState","GatekeeperAPIStatus","LOCATION_NOT_SUPPORTED","includes","isIssuedLocationNotSupported","ISSUED_LOCATION_NOT_SUPPORTED","isIssuedVpnNotSupported","ISSUED_VPN_NOT_SUPPORTED","isVpnNotSupported","VPN_NOT_SUPPORTED","State","ACTIVE","REFRESH_TOKEN_REQUIRED","PROOF_OF_WALLET_OWNERSHIP","REVOKED","FROZEN"],"mappings":"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","sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.statusFromToken = exports.resetState = void 0;\nconst types_1 = require(\"../types\");\n// eslint-disable-next-line import/prefer-default-export\nconst resetState = (state) => (Object.assign(Object.assign({}, state), { gatewayStatus: types_1.GatewayStatus.UNKNOWN, tokenRequested: false, iframeMinimized: false, firstTokenCheck: true, renderIframe: false, gatewayToken: undefined, powoRequested: undefined, refreshTimeoutId: undefined, powoFinished: false, refreshInProgress: false, tokenIssuanceState: types_1.TokenIssuanceState.NOT_REQUESTED, walletToRefresh: undefined, walletPowoInProgress: false, gatekeeperRecordState: undefined, civicPass: {\n        status: types_1.CivicPassIssuanceStatus.NOT_REQUESTED,\n        iframeMinimized: false,\n        renderIframe: false,\n    } }));\nexports.resetState = resetState;\nconst hasExpired = (gatewayToken) => {\n    const now = Math.floor(Date.now() / 1000);\n    return !!gatewayToken.expiryTime && now >= gatewayToken.expiryTime;\n};\nconst isLocationNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperAPIStatus.LOCATION_NOT_SUPPORTED].includes(recordState);\n};\nconst isIssuedLocationNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperAPIStatus.ISSUED_LOCATION_NOT_SUPPORTED].includes(recordState);\n};\nconst isIssuedVpnNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperAPIStatus.ISSUED_VPN_NOT_SUPPORTED].includes(recordState);\n};\nconst isVpnNotSupported = (recordState) => {\n    if (!recordState)\n        return false;\n    return [types_1.GatekeeperAPIStatus.VPN_NOT_SUPPORTED].includes(recordState);\n};\nconst statusFromToken = (state, gatewayToken) => {\n    if (!gatewayToken)\n        return state.gatewayStatus;\n    switch (gatewayToken.state) {\n        case types_1.State.ACTIVE:\n            if (isLocationNotSupported(state.gatekeeperRecordState)) {\n                return types_1.GatewayStatus.LOCATION_NOT_SUPPORTED;\n            }\n            if (isVpnNotSupported(state.gatekeeperRecordState) || isIssuedVpnNotSupported(state.gatekeeperRecordState)) {\n                return types_1.GatewayStatus.VPN_NOT_SUPPORTED;\n            }\n            if (isIssuedLocationNotSupported(state.gatekeeperRecordState)) {\n                return types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED;\n            }\n            if (state.gatewayStatus === types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP) {\n                return types_1.GatewayStatus.PROOF_OF_WALLET_OWNERSHIP;\n            }\n            return hasExpired(gatewayToken) ? types_1.GatewayStatus.REFRESH_TOKEN_REQUIRED : types_1.GatewayStatus.ACTIVE;\n        case types_1.State.REVOKED:\n            return types_1.GatewayStatus.REVOKED;\n        case types_1.State.FROZEN:\n            return types_1.GatewayStatus.FROZEN;\n        default:\n            return types_1.GatewayStatus.UNKNOWN;\n    }\n};\nexports.statusFromToken = statusFromToken;\n"]},"metadata":{},"sourceType":"script"}