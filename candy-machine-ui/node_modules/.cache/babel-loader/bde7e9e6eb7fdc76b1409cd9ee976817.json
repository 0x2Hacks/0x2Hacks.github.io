{"ast":null,"code":"\"use strict\";\n\nvar _regeneratorRuntime = require(\"/workspace/0x2Hacks.github.io/candy-machine-ui/node_modules/@babel/runtime/regenerator/index.js\");\n\nvar _asyncToGenerator = require(\"/workspace/0x2Hacks.github.io/candy-machine-ui/node_modules/@babel/runtime/helpers/asyncToGenerator.js\").default;\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.pollUntilConditionMet = exports.sleep = void 0;\n\nvar logger_1 = __importDefault(require(\"../logger\"));\n\nvar sleep = function sleep(ms) {\n  return new Promise(function (resolve) {\n    return setTimeout(resolve, ms);\n  });\n};\n\nexports.sleep = sleep;\n\nvar pollUntilConditionMet = /*#__PURE__*/function () {\n  var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(fnToRun, conditionChecker) {\n    var interval,\n        retries,\n        result,\n        _args = arguments;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            interval = _args.length > 2 && _args[2] !== undefined ? _args[2] : 2000;\n            retries = _args.length > 3 && _args[3] !== undefined ? _args[3] : 20;\n\n            if (!(retries <= 0)) {\n              _context.next = 5;\n              break;\n            }\n\n            logger_1.default.debug('WaitForStatusChange - no more retries');\n            throw new Error(\"pollUntilConditionMet all retries used calling \".concat(fnToRun));\n\n          case 5:\n            logger_1.default.debug(\"calling \".concat(fnToRun.name, \" retries = \").concat(retries));\n            _context.next = 8;\n            return fnToRun();\n\n          case 8:\n            result = _context.sent;\n\n            if (!conditionChecker(result)) {\n              _context.next = 11;\n              break;\n            }\n\n            return _context.abrupt(\"return\", result);\n\n          case 11:\n            logger_1.default.debug(\"Waiting \".concat(interval, \"ms before running \").concat(fnToRun.name, \" and checking condition \").concat(conditionChecker));\n            _context.next = 14;\n            return (0, exports.sleep)(interval);\n\n          case 14:\n            return _context.abrupt(\"return\", (0, exports.pollUntilConditionMet)(fnToRun, conditionChecker, interval, retries - 1));\n\n          case 15:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  }));\n\n  return function pollUntilConditionMet(_x, _x2) {\n    return _ref.apply(this, arguments);\n  };\n}();\n\nexports.pollUntilConditionMet = pollUntilConditionMet;","map":{"version":3,"sources":["/workspace/0x2Hacks.github.io/candy-machine-ui/node_modules/@civic/common-gateway-react/dist/esm/actionCreator/utils.js"],"names":["__importDefault","mod","__esModule","Object","defineProperty","exports","value","pollUntilConditionMet","sleep","logger_1","require","ms","Promise","resolve","setTimeout","fnToRun","conditionChecker","interval","retries","default","debug","Error","name","result"],"mappings":"AAAA;;;;;;AACA,IAAIA,eAAe,GAAI,QAAQ,KAAKA,eAAd,IAAkC,UAAUC,GAAV,EAAe;AACnE,SAAQA,GAAG,IAAIA,GAAG,CAACC,UAAZ,GAA0BD,GAA1B,GAAgC;AAAE,eAAWA;AAAb,GAAvC;AACH,CAFD;;AAGAE,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAAEC,EAAAA,KAAK,EAAE;AAAT,CAA7C;AACAD,OAAO,CAACE,qBAAR,GAAgCF,OAAO,CAACG,KAAR,GAAgB,KAAK,CAArD;;AACA,IAAMC,QAAQ,GAAGT,eAAe,CAACU,OAAO,CAAC,WAAD,CAAR,CAAhC;;AACA,IAAMF,KAAK,GAAG,SAARA,KAAQ,CAACG,EAAD,EAAQ;AAClB,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD;AAAA,WAAaC,UAAU,CAACD,OAAD,EAAUF,EAAV,CAAvB;AAAA,GAAZ,CAAP;AACH,CAFD;;AAGAN,OAAO,CAACG,KAAR,GAAgBA,KAAhB;;AACA,IAAMD,qBAAqB;AAAA,sEAAG,iBAAOQ,OAAP,EAAgBC,gBAAhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAkCC,YAAAA,QAAlC,2DAA6C,IAA7C;AAAmDC,YAAAA,OAAnD,2DAA6D,EAA7D;;AAAA,kBACtBA,OAAO,IAAI,CADW;AAAA;AAAA;AAAA;;AAEtBT,YAAAA,QAAQ,CAACU,OAAT,CAAiBC,KAAjB,CAAuB,uCAAvB;AAFsB,kBAGhB,IAAIC,KAAJ,0DAA4DN,OAA5D,EAHgB;;AAAA;AAK1BN,YAAAA,QAAQ,CAACU,OAAT,CAAiBC,KAAjB,mBAAkCL,OAAO,CAACO,IAA1C,wBAA4DJ,OAA5D;AAL0B;AAAA,mBAMJH,OAAO,EANH;;AAAA;AAMpBQ,YAAAA,MANoB;;AAAA,iBAOtBP,gBAAgB,CAACO,MAAD,CAPM;AAAA;AAAA;AAAA;;AAAA,6CAQfA,MARe;;AAAA;AAU1Bd,YAAAA,QAAQ,CAACU,OAAT,CAAiBC,KAAjB,mBAAkCH,QAAlC,+BAA+DF,OAAO,CAACO,IAAvE,qCAAsGN,gBAAtG;AAV0B;AAAA,mBAWpB,CAAC,GAAGX,OAAO,CAACG,KAAZ,EAAmBS,QAAnB,CAXoB;;AAAA;AAAA,6CAYnB,CAAC,GAAGZ,OAAO,CAACE,qBAAZ,EAAmCQ,OAAnC,EAA4CC,gBAA5C,EAA8DC,QAA9D,EAAwEC,OAAO,GAAG,CAAlF,CAZmB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAArBX,qBAAqB;AAAA;AAAA;AAAA,GAA3B;;AAcAF,OAAO,CAACE,qBAAR,GAAgCA,qBAAhC","sourcesContent":["\"use strict\";\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.pollUntilConditionMet = exports.sleep = void 0;\nconst logger_1 = __importDefault(require(\"../logger\"));\nconst sleep = (ms) => {\n    return new Promise((resolve) => setTimeout(resolve, ms));\n};\nexports.sleep = sleep;\nconst pollUntilConditionMet = async (fnToRun, conditionChecker, interval = 2000, retries = 20) => {\n    if (retries <= 0) {\n        logger_1.default.debug('WaitForStatusChange - no more retries');\n        throw new Error(`pollUntilConditionMet all retries used calling ${fnToRun}`);\n    }\n    logger_1.default.debug(`calling ${fnToRun.name} retries = ${retries}`);\n    const result = (await fnToRun());\n    if (conditionChecker(result)) {\n        return result;\n    }\n    logger_1.default.debug(`Waiting ${interval}ms before running ${fnToRun.name} and checking condition ${conditionChecker}`);\n    await (0, exports.sleep)(interval);\n    return (0, exports.pollUntilConditionMet)(fnToRun, conditionChecker, interval, retries - 1);\n};\nexports.pollUntilConditionMet = pollUntilConditionMet;\n"]},"metadata":{},"sourceType":"script"}