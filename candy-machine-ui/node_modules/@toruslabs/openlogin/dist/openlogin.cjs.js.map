{"version":3,"sources":["webpack://Openlogin/webpack/bootstrap","webpack://Openlogin/external \"@babel/runtime/regenerator\"","webpack://Openlogin/./src/constants.ts","webpack://Openlogin/external \"@babel/runtime/helpers/asyncToGenerator\"","webpack://Openlogin/external \"@babel/runtime/helpers/defineProperty\"","webpack://Openlogin/./src/utils.ts","webpack://Openlogin/external \"@toruslabs/openlogin-utils\"","webpack://Openlogin/external \"@toruslabs/openlogin-jrpc\"","webpack://Openlogin/external \"@babel/runtime/helpers/classCallCheck\"","webpack://Openlogin/external \"@babel/runtime/helpers/createClass\"","webpack://Openlogin/external \"@toruslabs/eccrypto\"","webpack://Openlogin/external \"@babel/runtime/helpers/assertThisInitialized\"","webpack://Openlogin/external \"@babel/runtime/helpers/slicedToArray\"","webpack://Openlogin/./src/OpenLogin.ts","webpack://Openlogin/./src/Provider.ts","webpack://Openlogin/./src/MemoryStore.ts","webpack://Openlogin/./src/OpenLoginStore.ts","webpack://Openlogin/external \"@babel/runtime/helpers/typeof\"","webpack://Openlogin/external \"@toruslabs/http-helpers\"","webpack://Openlogin/external \"@babel/runtime/helpers/getPrototypeOf\"","webpack://Openlogin//home/chai/source/repos/torus/OpenLoginSdk/node_modules/buffer/index.js","webpack://Openlogin/external \"lodash.merge\"","webpack://Openlogin/./src/Modal.ts","webpack://Openlogin/external \"@babel/runtime/helpers/inherits\"","webpack://Openlogin/external \"@babel/runtime/helpers/possibleConstructorReturn\"","webpack://Openlogin/external \"pump\"","webpack://Openlogin/./src/index.ts","webpack://Openlogin/(webpack)/buildin/global.js","webpack://Openlogin//home/chai/source/repos/torus/OpenLoginSdk/node_modules/base64-js/index.js","webpack://Openlogin//home/chai/source/repos/torus/OpenLoginSdk/node_modules/ieee754/index.js","webpack://Openlogin//home/chai/source/repos/torus/OpenLoginSdk/node_modules/isarray/index.js"],"names":["modalDOMElementID","storeKey","UX_MODE","POPUP","REDIRECT","OPENLOGIN_METHOD","LOGIN","LOGOUT","CHECK_3PC_SUPPORT","SET_PID_DATA","GET_DATA","ALLOWED_INTERACTIONS","JRPC","OPENLOGIN_NETWORK","MAINNET","TESTNET","DEVELOPMENT","LOGIN_PROVIDER","GOOGLE","FACEBOOK","REDDIT","DISCORD","TWITCH","APPLE","LINE","GITHUB","KAKAO","LINKEDIN","TWITTER","WEIBO","WECHAT","EMAIL_PASSWORDLESS","WEBAUTHN","JWT","documentReady","Promise","resolve","document","readyState","addEventListener","htmlToElement","html","template","window","createElement","trimmedHtml","trim","innerHTML","content","firstChild","whitelistUrl","clientId","appKey","origin","appKeyBuf","Buffer","from","padStart","base64url","encode","getPublic","Error","sign","keccak","update","digest","sig","getHashQueryParams","replaceUrl","result","url","URL","location","href","searchParams","forEach","value","key","queryResult","get","queryParams","JSON","parse","safeatob","Object","keys","error","console","hash","substr","hashUrl","hashResult","hashParams","cleanUrl","pathname","history","replaceState","awaitReq","id","windowRef","reject","closedByHandler","closedMonitor","setInterval","closed","clearInterval","handler","ev","pid","data","removeEventListener","close","constructURL","params","baseURL","query","append","h","toString","storageAvailable","type","storageExists","storageLength","storage","length","x","setItem","removeItem","code","name","sessionStorageAvailable","localStorageAvailable","preloadIframe","openloginIframeHtml","crossOrigin","rel","relList","supports","head","appendChild","getPopupFeatures","dualScreenLeft","screenLeft","undefined","screenX","dualScreenTop","screenTop","screenY","w","width","innerWidth","documentElement","clientWidth","screen","height","innerHeight","clientHeight","systemZoom","left","Math","abs","top","features","OpenLogin","options","provider","Proxy","Provider","deleteProperty","_iframeUrl","network","modal","Modal","initState","no3PC","_startUrl","_popupUrl","redirectUrl","protocol","host","uxMode","replaceUrlOnRedirect","originData","whiteLabel","loginConfig","state","privKey","store","OpenLoginStore","getInstance","iframeUrl","startUrl","popupUrl","support3PC","all","init","updateOriginData","iframeElem","_syncState","_check3PCSupport","res","_getData","filteredOriginData","stringify","getWhitelist","getWhiteLabel","whitelist","post","project_id","signed_urls","defaultParams","loginParams","request","fastLogin","method","allowedInteractions","loginProvider","_selectedLogin","_modal","logoutParams","_clientId","args","randomId","session","userData","timestamp","Date","now","_user","_userSig","_userData","_originData","_whiteLabelData","_loginConfig","includes","_jrpcRequest","_origin","_setPIDData","setTimeout","b64Params","jsonToBase64","_pid","_method","u","open","Array","isArray","push","_rpcRequest","getRpcPromiseCallback","newState","set","_prompt","chunk","cancel","merge","selectedLoginResponse","cleanup","message","privateKey","exec","encrypt","ciphertext","decrypt","storeData","getStore","userInfo","email","profileImage","aggregateVerifier","verifier","verifierId","typeOfLogin","setupStream","initialized","rpcStream","PostMessageStream","target","targetWindow","contentWindow","targetOrigin","mux","setupMultiplex","JRPCConnection","createStreamMiddleware","pump","stream","createStream","log","rpcEngine","JRPCEngine","createIdRemapMiddleware","middleware","payload","callback","jsonrpc","handle","SafeEventEmitter","MemoryStore","getItem","resetStore","currStore","instance","localStorage","handleStream","eventName","handlerWrapper","removeListener","on","modalUrl","initIFrame","verifierStream","src","documentIFrameElem","getElementById","remove","modalZIndex","_hideModal","body","onload","style","display","position","right","bottom","border","setAttribute","entries","map","k","v","join","cb","_showModal","modalHandler","write"],"mappings":"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A;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,mBAAmB,UAAU;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0BAA0B;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA,uCAAuC,SAAS;AAChD;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;AACA,aAAa,iBAAiB;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,gDAAgD,EAAE;AAClD;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA,iBAAiB,SAAS;AAC1B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;AACA;AACA,wBAAwB,eAAe;AACvC;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA,GAAG;AACH;AACA,wBAAwB,QAAQ;AAChC;AACA,qBAAqB,eAAe;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,kBAAkB;AACnC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA,mBAAmB,cAAc;AACjC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA,uDAAuD,OAAO;AAC9D;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,kBAAkB;AAClB;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,qBAAqB,QAAQ;AAC7B;AACA;AACA,GAAG;AACH;AACA,eAAe,SAAS;AACxB;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA,mBAAmB,SAAS;AAC5B;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA,eAAe,iBAAiB;AAChC;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA,iBAAiB,YAAY;AAC7B;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,iBAAiB,gBAAgB;AACjC;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,iBAAiB,gBAAgB;AACjC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,iBAAiB,YAAY;AAC7B;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;;;;;;AC5vDA,yC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACAA;AAEA;AACA;AAEO,IAAMoH,YAAY,GAAG,SAAfA,YAAe,CAACR,MAAD,EAAoBS,SAApB,EAAuCvM,OAAvC,EAA+E;AACzG,MAAMwM,cAAc,GAAG,SAAjBA,cAAiB,CAACrD,KAAD,EAAW;AAChCnJ,WAAO,CAACmJ,KAAD,CAAP;AACA2C,UAAM,CAACW,cAAP,CAAsBF,SAAtB,EAAiCC,cAAjC;AACD,GAHD;;AAIAV,QAAM,CAACY,EAAP,C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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;;;;;;;ACLA;;AAEA;AACA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA,CAAC;AACD;AACA;AACA;;AAEA;AACA;AACA,4CAA4C;;AAE5C;;;;;;;;ACnBY;;AAEZ;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,kCAAkC,SAAS;AAC3C;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;AACA,aAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,qBAAqB,SAAS;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,0CAA0C,UAAU;AACpD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;;;;;ACrJA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA;AACA,QAAQ,WAAW;;AAEnB;AACA;AACA,GAAG;AACH;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA,QAAQ,WAAW;;AAEnB;AACA;AACA,QAAQ,UAAU;;AAElB;AACA;;;;;;;ACpFA,iBAAiB;;AAEjB;AACA;AACA","file":"openlogin.cjs.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 25);\n","module.exports = require(\"@babel/runtime/regenerator\");","import { LoginConfig, OriginData, WhiteLabelData } from \"@toruslabs/openlogin-jrpc\";\nimport { ExtraLoginOptions } from \"@toruslabs/openlogin-utils\";\n\nexport const modalDOMElementID = \"openlogin-modal\";\n\nexport const storeKey = \"openlogin_store\";\n\nexport type PopupResponse<T> = {\n  pid: string;\n  data: T;\n};\n\nexport type Maybe<T> = Partial<T> | null | undefined;\n\nexport const UX_MODE = {\n  POPUP: \"popup\",\n  REDIRECT: \"redirect\",\n} as const;\n\nexport type UX_MODE_TYPE = typeof UX_MODE[keyof typeof UX_MODE];\n\nexport const OPENLOGIN_METHOD = {\n  LOGIN: \"openlogin_login\",\n  LOGOUT: \"openlogin_logout\",\n  CHECK_3PC_SUPPORT: \"openlogin_check_3PC_support\",\n  SET_PID_DATA: \"openlogin_set_pid_data\",\n  GET_DATA: \"openlogin_get_data\",\n} as const;\n\n// autocomplete workaround https://github.com/microsoft/TypeScript/issues/29729\nexport type CUSTOM_OPENLOGIN_METHOD_TYPE = string & { toString?: (radix?: number) => string };\n\nexport type OPENLOGIN_METHOD_TYPE = typeof OPENLOGIN_METHOD[keyof typeof OPENLOGIN_METHOD];\n\nexport const ALLOWED_INTERACTIONS = {\n  POPUP: \"popup\",\n  REDIRECT: \"redirect\",\n  JRPC: \"jrpc\",\n} as const;\n\nexport type ALLOWED_INTERACTIONS_TYPE = typeof ALLOWED_INTERACTIONS[keyof typeof ALLOWED_INTERACTIONS];\n\nexport type RequestParams = {\n  startUrl?: string;\n  popupUrl?: string;\n  method: OPENLOGIN_METHOD_TYPE | CUSTOM_OPENLOGIN_METHOD_TYPE;\n  params: Record<string, unknown>[];\n  allowedInteractions: ALLOWED_INTERACTIONS_TYPE[];\n};\n\nexport type BaseLogoutParams = {\n  /**\n   * You can get your clientId/projectId by registering your\n   * dapp on {@link \"https://developer.tor.us\"| developer dashbaord}\n   */\n  clientId: string;\n  /**\n   * Setting fastLogin to `true` will disable fast login for the user on this dapp.\n   *\n   * Defaults to false\n   * @defaultValue false\n   * @experimental\n   *\n   * @remarks\n   * Use this option with caution only when you are sure that you wish to disable fast login for the user on this dapp.\n   * In general you may not need to use this option.\n   */\n  fastLogin: boolean;\n};\n\nexport type BaseRedirectParams = {\n  /**\n   * redirectUrl is the dapp's url where user will be redirected after login.\n   *\n   * @remarks\n   * Register this url at {@link \"https://developer.tor.us\"| developer dashbaord}\n   * else initialization will give error.\n   */\n  redirectUrl?: string;\n  /**\n   * Any custom state you wish to pass along. This will be returned to you post redirect.\n   * Use this to store data that you want to be available to the dapp after login.\n   */\n  appState?: string;\n};\n\nexport const OPENLOGIN_NETWORK = {\n  MAINNET: \"mainnet\",\n  TESTNET: \"testnet\",\n  DEVELOPMENT: \"development\",\n} as const;\n\nexport type OPENLOGIN_NETWORK_TYPE = typeof OPENLOGIN_NETWORK[keyof typeof OPENLOGIN_NETWORK];\n\nexport type OpenLoginOptions = {\n  /**\n   * You can get your clientId/projectId by registering your\n   * dapp on {@link \"https://developer.tor.us\"| developer dashbaord}\n   */\n  clientId: string;\n\n  /**\n   * network specifies the openlogin iframe url url to be used.\n   *\n   * - `'mainnet'`: https://app.openlogin.com will be used which is the production version.\n   * - `'testnet'`: https://beta.openlogin.com will be used which is the beta version.\n   * - `'development'`: http://localhost:3000 will be used for development purpose.\n   */\n  network: OPENLOGIN_NETWORK_TYPE;\n\n  /**\n   * Setting no3PC forces openlogin to assume that third party cookies are blocked\n   * in the browser.\n   *\n   * @defaultValue false\n   * @remarks\n   * Only pass no3PC to `true` when you are sure that third party cookies are not\n   * supported. By default openlogin will self check third party cookies and proceed\n   * accordingly.\n   */\n  no3PC?: boolean;\n\n  /**\n   * redirectUrl is the dapp's url where user will be redirected after login.\n   *\n   * @remarks\n   * Register this url at {@link \"https://developer.tor.us\"| developer dashbaord}\n   * else initialization will give error.\n   */\n  redirectUrl?: string;\n\n  /**\n   * two uxModes are supported:-\n   * - `'POPUP'`: In this uxMode, a popup will be shown to user for login.\n   * - `'REDIRECT'`: In this uxMode, user will be redirected to a new window tab for login.\n   *\n   * @defaultValue `'POPUP'`\n   * @remarks\n   *\n   * Use of `'REDIRECT'` mode is recommended in browsers where popups might get blocked.\n   */\n  uxMode?: UX_MODE_TYPE;\n\n  /**\n   * replaceUrlOnRedirect removes the params from the redirected url after login\n   *\n   * @defaultValue true\n   */\n  replaceUrlOnRedirect?: boolean;\n\n  /**\n   * originData is used to verify the origin of dapp by iframe.\n   *\n   * @internal\n   * @remarks\n   * You don't have to pass originData explicitly if you have registered your dapp at\n   * {@link \"https://developer.tor.us\"| developer dashbaord}.\n   *\n   * originData contains a signature of dapp's origin url which is generated using\n   * project's secret.\n   */\n  originData?: OriginData;\n\n  /**\n   * loginConfig enables you to pass your own login verifiers configuration for various\n   * loginProviders.\n   *\n   * loginConfig is key value map where each key should be a valid loginProvider and value\n   * should be custom configuration for that loginProvider\n   *\n   * @remarks\n   * You can deploy your own verifiers from {@link \"https://developer.tor.us\"| developer dashbaord}\n   * to use here.\n   *\n   */\n  loginConfig?: LoginConfig;\n\n  /**\n   * _iframeUrl is for internal development use only and is used to override the\n   * `network` parameter.\n   * @internal\n   */\n  _iframeUrl?: string;\n  /**\n   * _startUrl is for internal development use only and is used specify authentication\n   * start url of iframe.\n   * @internal\n   */\n  _startUrl?: string;\n\n  /**\n   * _popupUrl is for internal development use only and is used specify url of popup window\n   * for popup uxMode.\n   * @internal\n   */\n  _popupUrl?: string;\n\n  /**\n   * options for whitelabling default openlogin modal.\n   */\n  whiteLabel?: WhiteLabelData;\n};\n\nexport const LOGIN_PROVIDER = {\n  GOOGLE: \"google\",\n  FACEBOOK: \"facebook\",\n  REDDIT: \"reddit\",\n  DISCORD: \"discord\",\n  TWITCH: \"twitch\",\n  APPLE: \"apple\",\n  LINE: \"line\",\n  GITHUB: \"github\",\n  KAKAO: \"kakao\",\n  LINKEDIN: \"linkedin\",\n  TWITTER: \"twitter\",\n  WEIBO: \"weibo\",\n  WECHAT: \"wechat\",\n  EMAIL_PASSWORDLESS: \"email_passwordless\",\n  WEBAUTHN: \"webauthn\",\n  JWT: \"jwt\",\n} as const;\n\n/**\n * {@label loginProviderType}\n */\nexport type LOGIN_PROVIDER_TYPE = typeof LOGIN_PROVIDER[keyof typeof LOGIN_PROVIDER];\n\n// autocomplete workaround https://github.com/microsoft/TypeScript/issues/29729\nexport type CUSTOM_LOGIN_PROVIDER_TYPE = string & { toString?: (radix?: number) => string };\n\nexport type LoginParams = BaseRedirectParams & {\n  /**\n   * loginProvider sets the oauth login method to be used.\n   * You can use any of the valid loginProvider from the supported list.\n   *\n   * If this param is not passed then it will show all the available\n   * login methods to user in a modal.\n   *\n   */\n  loginProvider?: LOGIN_PROVIDER_TYPE | CUSTOM_LOGIN_PROVIDER_TYPE;\n\n  /**\n   * Setting fastLogin to `true` will force user to login with webauthn if\n   * webauthn is available on device.\n   *\n   * Defaults to false\n   * @defaultValue false\n   * @experimental\n   *\n   * @remarks\n   * Use this option with caution only when you are sure about that user has\n   * enabled webauthn while registration, else don't use this option.\n   * Openlogin will itself take care of detecting and handling webauthn.\n   * In general you may not need to use this option.\n   */\n  fastLogin?: boolean;\n\n  /**\n   * Setting relogin to `true` will force user to relogin when login\n   * method is called even if user is already logged in. By default login\n   * method call skips login process if user is already logged in.\n   *\n   * * Defaults to false\n   * @defaultValue false\n   */\n  relogin?: boolean;\n\n  /**\n   * setting skipTKey to `true` will skip TKey onboarding for new users,\n   * whereas old users  will be presented with an option to skip tKey in UI\n   * if this option is enabled.\n   *\n   * Defaults to false\n   * @defaultValue false\n   */\n  skipTKey?: boolean;\n\n  /**\n   * This option is for internal use only in torus wallet and has not effect\n   * on user's login on other dapps.\n   *\n   * Defaults to false\n   * @defaultValue false\n   * @internal\n   */\n  getWalletKey?: boolean;\n\n  /**\n   * extraLoginOptions can be used to pass standard oauth login options to\n   * loginProvider.\n   *\n   * For ex: you will have to pass `login_hint` as user's email and `domain`\n   * as your app domain in `extraLoginOptions` while using `email_passwordless`\n   * loginProvider\n   */\n  extraLoginOptions?: ExtraLoginOptions;\n};\n\nexport type OpenloginUserInfo = {\n  email: string;\n  name: string;\n  profileImage: string;\n  aggregateVerifier: string;\n  verifier: string;\n  verifierId: string;\n  typeOfLogin: LOGIN_PROVIDER_TYPE | CUSTOM_LOGIN_PROVIDER_TYPE;\n};\n","module.exports = require(\"@babel/runtime/helpers/asyncToGenerator\");","module.exports = require(\"@babel/runtime/helpers/defineProperty\");","import { getPublic, sign } from \"@toruslabs/eccrypto\";\nimport { base64url, keccak, safeatob } from \"@toruslabs/openlogin-utils\";\n\nimport { PopupResponse } from \"./constants\";\n\nexport async function documentReady(): Promise<void> {\n  return new Promise<void>((resolve) => {\n    if (document.readyState !== \"loading\") {\n      resolve();\n    } else {\n      document.addEventListener(\"DOMContentLoaded\", () => {\n        resolve();\n      });\n    }\n  });\n}\n\nexport const htmlToElement = <T extends Element>(html: string): T => {\n  const template = window.document.createElement(\"template\");\n  const trimmedHtml = html.trim(); // Never return a text node of whitespace as the result\n  template.innerHTML = trimmedHtml;\n  return template.content.firstChild as T;\n};\n\nexport async function whitelistUrl(clientId: string, appKey: string, origin: string): Promise<string> {\n  const appKeyBuf = Buffer.from(appKey.padStart(64, \"0\"), \"hex\");\n  if (base64url.encode(getPublic(appKeyBuf)) !== clientId) throw new Error(\"appKey mismatch\");\n  const sig = await sign(appKeyBuf, Buffer.from(keccak(\"keccak256\").update(origin).digest(\"hex\"), \"hex\"));\n  return base64url.encode(sig);\n}\n\nexport function getHashQueryParams(replaceUrl = false): Record<string, string> {\n  const result = {};\n\n  const url = new URL(window.location.href);\n  url.searchParams.forEach((value, key) => {\n    if (key !== \"result\") {\n      result[key] = value;\n    }\n  });\n  const queryResult = url.searchParams.get(\"result\");\n  if (queryResult) {\n    try {\n      const queryParams = JSON.parse(safeatob(queryResult));\n      Object.keys(queryParams).forEach((key) => {\n        result[key] = queryParams[key];\n      });\n    } catch (error) {\n      window.console.error(error);\n    }\n  }\n\n  const hash = url.hash.substr(1);\n  const hashUrl = new URL(`${window.location.origin}/?${hash}`);\n  hashUrl.searchParams.forEach((value, key) => {\n    if (key !== \"result\") {\n      result[key] = value;\n    }\n  });\n  const hashResult = hashUrl.searchParams.get(\"result\");\n\n  if (hashResult) {\n    try {\n      const hashParams = JSON.parse(safeatob(hashResult));\n      Object.keys(hashParams).forEach((key) => {\n        result[key] = hashParams[key];\n      });\n    } catch (error) {\n      window.console.error(error);\n    }\n  }\n\n  if (replaceUrl) {\n    const cleanUrl = window.location.origin + window.location.pathname;\n    window.history.replaceState(null, \"\", cleanUrl);\n  }\n\n  return result;\n}\n\nexport function awaitReq<T>(id: string, windowRef: Window): Promise<T> {\n  return new Promise((resolve, reject) => {\n    if (!windowRef) reject(new Error(\"Unable to open window\"));\n    let closedByHandler = false;\n    const closedMonitor = setInterval(() => {\n      if (!closedByHandler && windowRef.closed) {\n        clearInterval(closedMonitor);\n        reject(new Error(\"user closed popup\"));\n      }\n    }, 500);\n    const handler = (ev: MessageEvent<PopupResponse<T & { error?: string }>>) => {\n      const { pid } = ev.data;\n      if (id !== pid) return;\n      window.removeEventListener(\"message\", handler);\n      closedByHandler = true;\n      clearInterval(closedMonitor);\n      windowRef.close();\n      if (ev.data.data && ev.data.data.error) {\n        reject(new Error(ev.data.data.error));\n      } else {\n        resolve(ev.data.data);\n      }\n    };\n\n    window.addEventListener(\"message\", handler);\n  });\n}\n\nexport function constructURL(params: { baseURL: string; query?: Record<string, unknown>; hash?: Record<string, unknown> }): string {\n  const { baseURL, query, hash } = params;\n\n  const url = new URL(baseURL);\n  if (query) {\n    Object.keys(query).forEach((key) => {\n      url.searchParams.append(key, query[key] as string);\n    });\n  }\n  if (hash) {\n    const h = new URL(constructURL({ baseURL, query: hash })).searchParams.toString();\n    url.hash = h;\n  }\n  return url.toString();\n}\n\nexport function storageAvailable(type: string): boolean {\n  let storageExists = false;\n  let storageLength = 0;\n  let storage: Storage;\n  try {\n    storage = window[type];\n    storageExists = true;\n    storageLength = storage.length;\n    const x = \"__storage_test__\";\n    storage.setItem(x, x);\n    storage.removeItem(x);\n    return true;\n  } catch (error) {\n    return (\n      error &&\n      // everything except Firefox\n      (error.code === 22 ||\n        // Firefox\n        error.code === 1014 ||\n        // test name field too, because code might not be present\n        // everything except Firefox\n        error.name === \"QuotaExceededErro r\" ||\n        // Firefox\n        error.name === \"NS_ERROR_DOM_QUOTA_REACHED\") &&\n      // acknowledge QuotaExceededError only if there's something already stored\n      storageExists &&\n      storageLength !== 0\n    );\n  }\n}\n\nexport const sessionStorageAvailable = storageAvailable(\"sessionStorage\");\nexport const localStorageAvailable = storageAvailable(\"localStorage\");\n\nexport function preloadIframe(url: string): void {\n  try {\n    const openloginIframeHtml = document.createElement(\"link\");\n    openloginIframeHtml.href = url;\n    openloginIframeHtml.crossOrigin = \"anonymous\";\n    openloginIframeHtml.type = \"text/html\";\n    openloginIframeHtml.rel = \"prefetch\";\n    if (openloginIframeHtml.relList && openloginIframeHtml.relList.supports) {\n      if (openloginIframeHtml.relList.supports(\"prefetch\")) {\n        document.head.appendChild(openloginIframeHtml);\n      }\n    }\n  } catch (error) {\n    window.console.error(error);\n  }\n}\n\nexport function getPopupFeatures(): string {\n  // Fixes dual-screen position                             Most browsers      Firefox\n  const dualScreenLeft = window.screenLeft !== undefined ? window.screenLeft : window.screenX;\n  const dualScreenTop = window.screenTop !== undefined ? window.screenTop : window.screenY;\n\n  const w = 1200;\n  const h = 700;\n\n  const width = window.innerWidth\n    ? window.innerWidth\n    : document.documentElement.clientWidth\n    ? document.documentElement.clientWidth\n    : window.screen.width;\n\n  const height = window.innerHeight\n    ? window.innerHeight\n    : document.documentElement.clientHeight\n    ? document.documentElement.clientHeight\n    : window.screen.height;\n\n  const systemZoom = 1; // No reliable estimate\n\n  const left = Math.abs((width - w) / 2 / systemZoom + dualScreenLeft);\n  const top = Math.abs((height - h) / 2 / systemZoom + dualScreenTop);\n  const features = `titlebar=0,toolbar=0,status=0,location=0,menubar=0,height=${h / systemZoom},width=${w / systemZoom},top=${top},left=${left}`;\n  return features;\n}\n","module.exports = require(\"@toruslabs/openlogin-utils\");","module.exports = require(\"@toruslabs/openlogin-jrpc\");","module.exports = require(\"@babel/runtime/helpers/classCallCheck\");","module.exports = require(\"@babel/runtime/helpers/createClass\");","module.exports = require(\"@toruslabs/eccrypto\");","module.exports = require(\"@babel/runtime/helpers/assertThisInitialized\");","module.exports = require(\"@babel/runtime/helpers/slicedToArray\");","import { decrypt, Ecies, encrypt, getPublic, sign } from \"@toruslabs/eccrypto\";\nimport { post } from \"@toruslabs/http-helpers\";\nimport { getRpcPromiseCallback, JRPCRequest, LoginConfig, OriginData, SessionInfo, WhiteLabelData } from \"@toruslabs/openlogin-jrpc\";\nimport { base64url, jsonToBase64, keccak, randomId } from \"@toruslabs/openlogin-utils\";\nimport merge from \"lodash.merge\";\n\nimport {\n  ALLOWED_INTERACTIONS,\n  BaseLogoutParams,\n  BaseRedirectParams,\n  CUSTOM_LOGIN_PROVIDER_TYPE,\n  LOGIN_PROVIDER_TYPE,\n  LoginParams,\n  OPENLOGIN_METHOD,\n  OPENLOGIN_NETWORK,\n  OPENLOGIN_NETWORK_TYPE,\n  OpenLoginOptions,\n  OpenloginUserInfo,\n  RequestParams,\n  UX_MODE,\n  UX_MODE_TYPE,\n} from \"./constants\";\nimport { Modal } from \"./Modal\";\nimport OpenLoginStore from \"./OpenLoginStore\";\nimport Provider from \"./Provider\";\nimport { awaitReq, constructURL, getHashQueryParams, getPopupFeatures, preloadIframe } from \"./utils\";\n\npreloadIframe(\"https://app.openlogin.com/sdk-modal\");\n\nexport type OpenLoginState = {\n  network: OPENLOGIN_NETWORK_TYPE;\n  privKey?: string;\n  walletKey?: string;\n  tKey?: string;\n  oAuthPrivateKey?: string;\n  support3PC?: boolean;\n  clientId: string;\n  iframeUrl: string;\n  redirectUrl: string;\n  startUrl: string;\n  popupUrl: string;\n  store: OpenLoginStore;\n  uxMode: UX_MODE_TYPE;\n  replaceUrlOnRedirect: boolean;\n  originData: OriginData;\n  whiteLabel: WhiteLabelData;\n  loginConfig: LoginConfig;\n};\n\nclass OpenLogin {\n  provider: Provider;\n\n  state: OpenLoginState;\n\n  modal: Modal;\n\n  constructor(options: OpenLoginOptions) {\n    this.provider = new Proxy(new Provider(), {\n      deleteProperty: () => true, // work around for web3\n    });\n    if (!options._iframeUrl) {\n      if (options.network === OPENLOGIN_NETWORK.MAINNET) {\n        options._iframeUrl = \"https://app.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.TESTNET) {\n        options._iframeUrl = \"https://beta.openlogin.com\";\n      } else if (options.network === OPENLOGIN_NETWORK.DEVELOPMENT) {\n        options._iframeUrl = \"http://localhost:3000\";\n      }\n    }\n    if (!options._iframeUrl) {\n      throw new Error(\"unspecified network and iframeUrl\");\n    }\n    this.modal = new Modal(`${options._iframeUrl}/sdk-modal`);\n    this.initState({\n      ...options,\n      no3PC: options.no3PC ?? false,\n      _iframeUrl: options._iframeUrl,\n      _startUrl: options._startUrl ?? `${options._iframeUrl}/start`,\n      _popupUrl: options._popupUrl ?? `${options._iframeUrl}/popup-window`,\n      redirectUrl: options.redirectUrl ?? `${window.location.protocol}//${window.location.host}${window.location.pathname}`,\n      uxMode: options.uxMode ?? UX_MODE.REDIRECT,\n      replaceUrlOnRedirect: options.replaceUrlOnRedirect ?? true,\n      originData: options.originData ?? { [window.location.origin]: \"\" },\n      whiteLabel: options.whiteLabel ?? {},\n      loginConfig: options.loginConfig ?? {},\n    });\n  }\n\n  get privKey(): string {\n    return this.state.privKey ? this.state.privKey.padStart(64, \"0\") : \"\";\n  }\n\n  initState(options: Required<OpenLoginOptions>): void {\n    this.state = {\n      uxMode: options.uxMode,\n      network: options.network,\n      store: OpenLoginStore.getInstance(),\n      iframeUrl: options._iframeUrl,\n      startUrl: options._startUrl,\n      popupUrl: options._popupUrl,\n      clientId: options.clientId,\n      redirectUrl: options.redirectUrl,\n      replaceUrlOnRedirect: options.replaceUrlOnRedirect,\n      originData: options.originData,\n      loginConfig: options.loginConfig,\n      support3PC: !options.no3PC,\n      whiteLabel: options.whiteLabel,\n    };\n  }\n\n  async init(): Promise<void> {\n    if (this.state.support3PC) {\n      await Promise.all([this.modal.init(), this.updateOriginData()]);\n      this.provider.init({ iframeElem: this.modal.iframeElem, iframeUrl: this.state.iframeUrl });\n      this._syncState(getHashQueryParams(this.state.replaceUrlOnRedirect));\n      const res = await this._check3PCSupport();\n      this.state.support3PC = !!res.support3PC;\n      if (this.state.support3PC) {\n        this._syncState(await this._getData());\n      }\n    } else {\n      await this.updateOriginData();\n      this._syncState(getHashQueryParams(this.state.replaceUrlOnRedirect));\n    }\n  }\n\n  async updateOriginData(): Promise<void> {\n    const filteredOriginData = JSON.parse(JSON.stringify(this.state.originData));\n    Object.keys(filteredOriginData).forEach((key) => {\n      if (filteredOriginData[key] === \"\") delete filteredOriginData[key];\n    });\n    const [whitelist, whiteLabel] = await Promise.all([this.getWhitelist(), this.getWhiteLabel()]);\n    this._syncState({ originData: { ...whitelist, ...filteredOriginData }, whiteLabel: { ...whiteLabel, ...this.state.whiteLabel } });\n  }\n\n  async getWhitelist(): Promise<OriginData> {\n    try {\n      const { clientId } = this.state;\n      if (!clientId) {\n        throw new Error(\"unspecified clientId\");\n      }\n      const res = await post<{ signed_urls: OriginData }>(\"https://api.developer.tor.us/whitelist\", {\n        project_id: this.state.clientId,\n      });\n      return res.signed_urls;\n    } catch (_) {\n      // fail silently\n      return {};\n    }\n  }\n\n  async getWhiteLabel(): Promise<WhiteLabelData> {\n    try {\n      const { clientId } = this.state;\n      if (!clientId) {\n        throw new Error(\"unspecified clientId\");\n      }\n      const res = await post<{ whiteLabel: WhiteLabelData }>(\"https://api.developer.tor.us/whitelabel\", {\n        project_id: this.state.clientId,\n      });\n      return res.whiteLabel;\n    } catch (_) {\n      // fail silently\n      return {};\n    }\n  }\n\n  async _fastLogin(params: Partial<BaseRedirectParams>): Promise<{ privKey: string }> {\n    const defaultParams: BaseRedirectParams = {\n      redirectUrl: this.state.redirectUrl,\n    };\n\n    const loginParams: BaseRedirectParams = {\n      ...defaultParams,\n      ...params,\n    };\n\n    const res = await this.request<{ privKey: string }>({\n      params: [{ ...loginParams, fastLogin: true }],\n      method: OPENLOGIN_METHOD.LOGIN,\n      startUrl: this.state.startUrl,\n      popupUrl: this.state.popupUrl,\n      allowedInteractions: [ALLOWED_INTERACTIONS.POPUP, ALLOWED_INTERACTIONS.REDIRECT],\n    });\n\n    this.state.privKey = res.privKey;\n    return res;\n  }\n\n  async login(params?: LoginParams & Partial<BaseRedirectParams>): Promise<{ privKey: string }> {\n    if (params?.loginProvider) {\n      return this._selectedLogin(params);\n    }\n    return this._modal(params);\n  }\n\n  async _selectedLogin(params: LoginParams & Partial<BaseRedirectParams>): Promise<{ privKey: string }> {\n    const defaultParams: BaseRedirectParams = {\n      redirectUrl: this.state.redirectUrl,\n    };\n\n    const loginParams: LoginParams = {\n      loginProvider: params.loginProvider,\n      ...defaultParams,\n      ...params,\n    };\n\n    // fast login flow\n    // if (this.state.store.get(\"touchIDPreference\") === \"enabled\" && !loginParams.extraLoginOptions?.login_hint) {\n    //   return this._fastLogin(loginParams);\n    // }\n\n    const res = await this.request<{ privKey: string }>({\n      method: OPENLOGIN_METHOD.LOGIN,\n      allowedInteractions: [UX_MODE.REDIRECT, UX_MODE.POPUP],\n      startUrl: this.state.startUrl,\n      popupUrl: this.state.popupUrl,\n      params: [loginParams],\n    });\n    this.state.privKey = res.privKey;\n    return { privKey: this.privKey };\n  }\n\n  async logout(logoutParams: Partial<BaseLogoutParams> & Partial<BaseRedirectParams> = {}): Promise<void> {\n    const params: Record<string, unknown> = {};\n    // defaults\n    params.redirectUrl = this.state.redirectUrl;\n    params._clientId = this.state.clientId;\n\n    if (logoutParams.clientId) {\n      params._clientId = logoutParams.clientId;\n    }\n    if (logoutParams.fastLogin !== undefined) {\n      params.fastLogin = logoutParams.fastLogin;\n    }\n    if (logoutParams.redirectUrl !== undefined) {\n      params.redirectUrl = logoutParams.redirectUrl;\n    }\n\n    const res = await this.request<void>({\n      method: OPENLOGIN_METHOD.LOGOUT,\n      params: [params],\n      startUrl: this.state.startUrl,\n      popupUrl: this.state.popupUrl,\n      allowedInteractions: [ALLOWED_INTERACTIONS.JRPC, ALLOWED_INTERACTIONS.POPUP, ALLOWED_INTERACTIONS.REDIRECT],\n    });\n\n    this.state.privKey = \"\";\n    // if (!params.fastLogin) this.state.store.set(\"touchIDPreference\", \"disabled\");\n    return res;\n  }\n\n  async request<T>(args: RequestParams): Promise<T> {\n    const pid = randomId();\n    let { params } = args;\n\n    // Note: _origin is added later in postMessageStream for jrpc requests\n    // do not add it here since its used for checking postMessage constraints\n    const session: Partial<SessionInfo> = {};\n    if (params.length !== 1) throw new Error(\"request params array should have only one element\");\n    const { startUrl, popupUrl, method, allowedInteractions } = args;\n    if (allowedInteractions.length === 0) throw new Error(\"no allowed interactions\");\n\n    if (this.state.clientId) {\n      session._clientId = this.state.clientId;\n    }\n\n    if (this.privKey) {\n      const userData = {\n        clientId: session._clientId,\n        timestamp: Date.now().toString(),\n      };\n      const sig = await sign(\n        Buffer.from(this.privKey, \"hex\"),\n        Buffer.from(keccak(\"keccak256\").update(JSON.stringify(userData)).digest(\"hex\"), \"hex\")\n      );\n      session._user = getPublic(Buffer.from(this.privKey, \"hex\")).toString(\"hex\");\n      session._userSig = base64url.encode(sig);\n      session._userData = userData;\n    }\n\n    session._originData = this.state.originData;\n    session._whiteLabelData = this.state.whiteLabel;\n    session._loginConfig = this.state.loginConfig;\n\n    // add in session data (allow overrides)\n    params = [{ ...session, ...params[0] }];\n\n    // use JRPC where possible\n\n    if (this.state.support3PC && allowedInteractions.includes(ALLOWED_INTERACTIONS.JRPC)) {\n      return this._jrpcRequest<Record<string, unknown>[], T>({ method, params });\n    }\n\n    // set origin\n    params[0]._origin = new URL((params[0].redirectUrl as string) ?? this.state.redirectUrl).origin;\n\n    // preset params\n    if (this.state.support3PC) {\n      // set params first if 3PC supported\n      await this._setPIDData(pid, params);\n      // eslint-disable-next-line require-atomic-updates\n      params = [{}];\n    }\n\n    if (!startUrl || !popupUrl) {\n      throw new Error(\"no url for redirect / popup flow\");\n    }\n\n    // method and pid are always in URL hash params\n    // convert params from JSON to base64\n\n    if (this.state.uxMode === UX_MODE.REDIRECT) {\n      // if redirects preferred, check for redirect flows first, then check for popup flow\n\n      if (allowedInteractions.includes(ALLOWED_INTERACTIONS.REDIRECT)) {\n        // give time for synchronous methods to complete before redirect\n        setTimeout(() => {\n          window.location.href = constructURL({\n            baseURL: startUrl,\n            hash: { b64Params: jsonToBase64(params[0]), _pid: pid, _method: method },\n          });\n        }, 50);\n        return {} as T;\n      }\n\n      if (allowedInteractions.includes(ALLOWED_INTERACTIONS.POPUP)) {\n        const u = new URL(\n          constructURL({\n            baseURL: popupUrl,\n            hash: { b64Params: jsonToBase64(params[0]), _pid: pid, _method: method },\n          })\n        );\n        const windowRef = window.open(u.toString(), \"_blank\", getPopupFeatures());\n        return awaitReq<T>(pid, windowRef);\n      }\n    } else {\n      // if popups preferred, check for popup flows first, then check for redirect flow\n\n      if (allowedInteractions.includes(ALLOWED_INTERACTIONS.POPUP)) {\n        const u = new URL(\n          constructURL({\n            baseURL: popupUrl,\n            hash: { b64Params: jsonToBase64(params[0]), _pid: pid, _method: method },\n          })\n        );\n        const windowRef = window.open(u.toString(), \"_blank\", getPopupFeatures());\n        return awaitReq<T>(pid, windowRef);\n      }\n\n      if (allowedInteractions.includes(ALLOWED_INTERACTIONS.REDIRECT)) {\n        // give time for synchronous methods to complete before redirect\n        setTimeout(() => {\n          window.location.href = constructURL({\n            baseURL: startUrl,\n            hash: { b64Params: jsonToBase64(params[0]), _pid: pid, _method: method },\n          });\n        }, 50);\n        return null;\n      }\n    }\n\n    throw new Error(\"no matching allowed interactions\");\n  }\n\n  async _jrpcRequest<T, U>(args: JRPCRequest<T>): Promise<U> {\n    // await this.initialized;\n    if (!args || typeof args !== \"object\" || Array.isArray(args)) {\n      throw new Error(\"invalid request args\");\n    }\n\n    const { method, params } = args;\n\n    if (typeof method !== \"string\" || method.length === 0) {\n      throw new Error(\"invalid request method\");\n    }\n\n    if (params === undefined || !Array.isArray(params)) {\n      throw new Error(\"invalid request params\");\n    }\n\n    if (params.length === 0) {\n      params.push({});\n    }\n\n    return new Promise<U>((resolve, reject) => {\n      this.provider._rpcRequest({ method, params }, getRpcPromiseCallback(resolve, reject));\n    });\n  }\n\n  async _check3PCSupport(): Promise<Record<string, boolean>> {\n    return this._jrpcRequest<Record<string, unknown>[], Record<string, boolean>>({\n      method: OPENLOGIN_METHOD.CHECK_3PC_SUPPORT,\n      params: [{ _originData: this.state.originData }],\n    });\n  }\n\n  async _setPIDData(pid: string, data: Record<string, unknown>[]): Promise<void> {\n    await this.request({\n      allowedInteractions: [ALLOWED_INTERACTIONS.JRPC],\n      method: OPENLOGIN_METHOD.SET_PID_DATA,\n      params: [\n        {\n          pid,\n          data: data[0],\n        },\n      ],\n    });\n  }\n\n  async _getData(): Promise<Record<string, unknown>> {\n    return this.request<Record<string, unknown>>({\n      allowedInteractions: [ALLOWED_INTERACTIONS.JRPC],\n      method: OPENLOGIN_METHOD.GET_DATA,\n      params: [{}],\n    });\n  }\n\n  _syncState(newState: Record<string, unknown>): void {\n    if (newState.store) {\n      if (typeof newState.store !== \"object\") {\n        throw new Error(\"expected store to be an object\");\n      }\n      Object.keys(newState.store).forEach((key) => {\n        this.state.store.set(key, newState.store[key]);\n      });\n    }\n    const { store } = this.state;\n    this.state = { ...this.state, ...newState, store };\n  }\n\n  async _modal(params?: LoginParams & Partial<BaseRedirectParams>): Promise<{\n    privKey: string;\n  }> {\n    return new Promise<{ privKey: string }>((resolve, reject) => {\n      this.modal._prompt(this.state.clientId, this.state.whiteLabel, this.state.loginConfig, async (chunk): Promise<void> => {\n        if (chunk.cancel) {\n          reject(new Error(\"user canceled login\"));\n        } else {\n          try {\n            const selectedLoginResponse = await this._selectedLogin(merge(params, chunk));\n            resolve(selectedLoginResponse);\n          } catch (error) {\n            reject(error);\n          }\n        }\n      });\n    });\n  }\n\n  async _cleanup(): Promise<void> {\n    await this.modal.cleanup();\n    this.provider.cleanup();\n  }\n\n  async encrypt(message: Buffer, privateKey?: string): Promise<Ecies> {\n    let privKey = privateKey;\n    if (!privKey) {\n      privKey = this.privKey;\n    }\n    // validations\n    if (!/^[0-9a-fA-f]{64}$/.exec(privKey)) {\n      if (privKey === \"\" || privKey === undefined) {\n        throw new Error(\"private key cannot be empty\");\n      } else {\n        throw new Error(\"invalid private key in encrypt\");\n      }\n    }\n    return encrypt(getPublic(Buffer.from(privKey, \"hex\")), message);\n  }\n\n  async decrypt(ciphertext: Ecies, privateKey?: string): Promise<Buffer> {\n    let privKey = privateKey;\n    if (!privKey) {\n      privKey = this.privKey;\n    }\n    // validations\n    if (!/^[0-9a-fA-f]{64}$/.exec(privKey)) {\n      if (privKey === \"\" || privKey === undefined) {\n        throw new Error(\"private key cannot be empty\");\n      } else {\n        throw new Error(\"invalid private key in decrypt\");\n      }\n    }\n    return decrypt(Buffer.from(privKey, \"hex\"), ciphertext);\n  }\n\n  async getUserInfo(): Promise<OpenloginUserInfo> {\n    if (this.privKey) {\n      const storeData = this.state.store.getStore();\n      const userInfo: OpenloginUserInfo = {\n        email: (storeData.email as string) || \"\",\n        name: (storeData.name as string) || \"\",\n        profileImage: (storeData.profileImage as string) || \"\",\n        aggregateVerifier: (storeData.aggregateVerifier as string) || \"\",\n        verifier: (storeData.verifier as string) || \"\",\n        verifierId: (storeData.verifierId as string) || \"\",\n        typeOfLogin: (storeData.typeOfLogin as LOGIN_PROVIDER_TYPE | CUSTOM_LOGIN_PROVIDER_TYPE) || \"\",\n      };\n\n      return userInfo;\n    }\n    throw new Error(\"user should be logged in to fetch userInfo\");\n  }\n}\n\nexport default OpenLogin;\n","import {\n  createIdRemapMiddleware,\n  createStreamMiddleware,\n  JRPCEngine,\n  JRPCRequest,\n  ObjectMultiplex,\n  PostMessageStream,\n  SafeEventEmitter,\n  setupMultiplex,\n  Stream,\n} from \"@toruslabs/openlogin-jrpc\";\nimport { randomId } from \"@toruslabs/openlogin-utils\";\nimport pump from \"pump\";\n\nexport default class Provider extends SafeEventEmitter {\n  iframeElem: HTMLIFrameElement | null = null;\n\n  rpcStream: PostMessageStream;\n\n  iframeUrl: string;\n\n  rpcEngine: JRPCEngine;\n\n  initialized: boolean;\n\n  mux: ObjectMultiplex;\n\n  init({ iframeElem, iframeUrl }: { iframeElem: HTMLIFrameElement; iframeUrl: string }): void {\n    this.iframeElem = iframeElem;\n    this.iframeUrl = iframeUrl;\n    this.setupStream();\n    this.initialized = true;\n  }\n\n  setupStream(): void {\n    if (this.iframeElem === null) throw new Error(\"iframe is null\");\n    this.rpcStream = new PostMessageStream({\n      name: \"embed_rpc\",\n      target: \"iframe_rpc\",\n      targetWindow: this.iframeElem.contentWindow,\n      targetOrigin: new URL(this.iframeUrl).origin,\n    });\n\n    this.mux = setupMultiplex(this.rpcStream);\n\n    const JRPCConnection = createStreamMiddleware();\n    pump(\n      JRPCConnection.stream as unknown as Stream,\n      this.mux.createStream(\"jrpc\") as unknown as Stream,\n      JRPCConnection.stream as unknown as Stream,\n      (error) => {\n        window.console.log(`JRPC connection broken`, error);\n      }\n    );\n\n    const rpcEngine = new JRPCEngine();\n    rpcEngine.push(createIdRemapMiddleware());\n    rpcEngine.push(JRPCConnection.middleware);\n    this.rpcEngine = rpcEngine;\n  }\n\n  cleanup(): void {\n    this.iframeElem = null;\n    this.initialized = false;\n  }\n\n  _rpcRequest(payload: JRPCRequest<unknown>, callback: (...args: any[]) => void): void {\n    if (!payload.jsonrpc) {\n      payload.jsonrpc = \"2.0\";\n    }\n    if (!payload.id) {\n      payload.id = randomId();\n    }\n    this.rpcEngine.handle(payload, callback);\n  }\n}\n","import { IStore } from \"./IStore\";\n\nexport class MemoryStore implements IStore {\n  store: Record<string, string> = {};\n\n  getItem(key: string): string {\n    return this.store[key];\n  }\n\n  setItem(key: string, value: string): void {\n    this.store[key] = value;\n  }\n}\n","import { storeKey } from \"./constants\";\nimport { IStore } from \"./IStore\";\nimport { MemoryStore } from \"./MemoryStore\";\nimport { localStorageAvailable } from \"./utils\";\n\nexport default class OpenLoginStore {\n  // eslint-disable-next-line no-use-before-define\n  private static instance: OpenLoginStore;\n\n  public storage: IStore;\n\n  private constructor(storage: IStore) {\n    this.storage = storage;\n    try {\n      if (!storage.getItem(storeKey)) {\n        this.resetStore();\n      }\n    } catch (error) {\n      // Storage is not available\n    }\n  }\n\n  static getInstance(): OpenLoginStore {\n    if (!this.instance) {\n      this.instance = new this(localStorageAvailable ? localStorage : new MemoryStore());\n    }\n    return this.instance;\n  }\n\n  toJSON(): string {\n    return this.storage.getItem(storeKey);\n  }\n\n  resetStore(): Record<string, unknown> {\n    const currStore = this.getStore();\n    this.storage.setItem(storeKey, JSON.stringify({}));\n    return currStore;\n  }\n\n  getStore(): Record<string, unknown> {\n    return JSON.parse(this.storage.getItem(storeKey));\n  }\n\n  get<T>(key: string): T {\n    const store = JSON.parse(this.storage.getItem(storeKey));\n    return store[key];\n  }\n\n  set<T>(key: string, value: T): void {\n    const store = JSON.parse(this.storage.getItem(storeKey));\n    store[key] = value;\n    this.storage.setItem(storeKey, JSON.stringify(store));\n  }\n}\n","module.exports = require(\"@babel/runtime/helpers/typeof\");","module.exports = require(\"@toruslabs/http-helpers\");","module.exports = require(\"@babel/runtime/helpers/getPrototypeOf\");","/*!\n * The buffer module from node.js, for the browser.\n *\n * @author   Feross Aboukhadijeh <http://feross.org>\n * @license  MIT\n */\n/* eslint-disable no-proto */\n\n'use strict'\n\nvar base64 = require('base64-js')\nvar ieee754 = require('ieee754')\nvar isArray = require('isarray')\n\nexports.Buffer = Buffer\nexports.SlowBuffer = SlowBuffer\nexports.INSPECT_MAX_BYTES = 50\n\n/**\n * If `Buffer.TYPED_ARRAY_SUPPORT`:\n *   === true    Use Uint8Array implementation (fastest)\n *   === false   Use Object implementation (most compatible, even IE6)\n *\n * Browsers that support typed arrays are IE 10+, Firefox 4+, Chrome 7+, Safari 5.1+,\n * Opera 11.6+, iOS 4.2+.\n *\n * Due to various browser bugs, sometimes the Object implementation will be used even\n * when the browser supports typed arrays.\n *\n * Note:\n *\n *   - Firefox 4-29 lacks support for adding new properties to `Uint8Array` instances,\n *     See: https://bugzilla.mozilla.org/show_bug.cgi?id=695438.\n *\n *   - Chrome 9-10 is missing the `TypedArray.prototype.subarray` function.\n *\n *   - IE10 has a broken `TypedArray.prototype.subarray` function which returns arrays of\n *     incorrect length in some situations.\n\n * We detect these buggy browsers and set `Buffer.TYPED_ARRAY_SUPPORT` to `false` so they\n * get the Object implementation, which is slower but behaves correctly.\n */\nBuffer.TYPED_ARRAY_SUPPORT = global.TYPED_ARRAY_SUPPORT !== undefined\n  ? global.TYPED_ARRAY_SUPPORT\n  : typedArraySupport()\n\n/*\n * Export kMaxLength after typed array support is determined.\n */\nexports.kMaxLength = kMaxLength()\n\nfunction typedArraySupport () {\n  try {\n    var arr = new Uint8Array(1)\n    arr.__proto__ = {__proto__: Uint8Array.prototype, foo: function () { return 42 }}\n    return arr.foo() === 42 && // typed array instances can be augmented\n        typeof arr.subarray === 'function' && // chrome 9-10 lack `subarray`\n        arr.subarray(1, 1).byteLength === 0 // ie10 has broken `subarray`\n  } catch (e) {\n    return false\n  }\n}\n\nfunction kMaxLength () {\n  return Buffer.TYPED_ARRAY_SUPPORT\n    ? 0x7fffffff\n    : 0x3fffffff\n}\n\nfunction createBuffer (that, length) {\n  if (kMaxLength() < length) {\n    throw new RangeError('Invalid typed array length')\n  }\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = new Uint8Array(length)\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    if (that === null) {\n      that = new Buffer(length)\n    }\n    that.length = length\n  }\n\n  return that\n}\n\n/**\n * The Buffer constructor returns instances of `Uint8Array` that have their\n * prototype changed to `Buffer.prototype`. Furthermore, `Buffer` is a subclass of\n * `Uint8Array`, so the returned instances will have all the node `Buffer` methods\n * and the `Uint8Array` methods. Square bracket notation works as expected -- it\n * returns a single octet.\n *\n * The `Uint8Array` prototype remains unmodified.\n */\n\nfunction Buffer (arg, encodingOrOffset, length) {\n  if (!Buffer.TYPED_ARRAY_SUPPORT && !(this instanceof Buffer)) {\n    return new Buffer(arg, encodingOrOffset, length)\n  }\n\n  // Common case.\n  if (typeof arg === 'number') {\n    if (typeof encodingOrOffset === 'string') {\n      throw new Error(\n        'If encoding is specified then the first argument must be a string'\n      )\n    }\n    return allocUnsafe(this, arg)\n  }\n  return from(this, arg, encodingOrOffset, length)\n}\n\nBuffer.poolSize = 8192 // not used by this implementation\n\n// TODO: Legacy, not needed anymore. Remove in next major version.\nBuffer._augment = function (arr) {\n  arr.__proto__ = Buffer.prototype\n  return arr\n}\n\nfunction from (that, value, encodingOrOffset, length) {\n  if (typeof value === 'number') {\n    throw new TypeError('\"value\" argument must not be a number')\n  }\n\n  if (typeof ArrayBuffer !== 'undefined' && value instanceof ArrayBuffer) {\n    return fromArrayBuffer(that, value, encodingOrOffset, length)\n  }\n\n  if (typeof value === 'string') {\n    return fromString(that, value, encodingOrOffset)\n  }\n\n  return fromObject(that, value)\n}\n\n/**\n * Functionally equivalent to Buffer(arg, encoding) but throws a TypeError\n * if value is a number.\n * Buffer.from(str[, encoding])\n * Buffer.from(array)\n * Buffer.from(buffer)\n * Buffer.from(arrayBuffer[, byteOffset[, length]])\n **/\nBuffer.from = function (value, encodingOrOffset, length) {\n  return from(null, value, encodingOrOffset, length)\n}\n\nif (Buffer.TYPED_ARRAY_SUPPORT) {\n  Buffer.prototype.__proto__ = Uint8Array.prototype\n  Buffer.__proto__ = Uint8Array\n  if (typeof Symbol !== 'undefined' && Symbol.species &&\n      Buffer[Symbol.species] === Buffer) {\n    // Fix subarray() in ES2016. See: https://github.com/feross/buffer/pull/97\n    Object.defineProperty(Buffer, Symbol.species, {\n      value: null,\n      configurable: true\n    })\n  }\n}\n\nfunction assertSize (size) {\n  if (typeof size !== 'number') {\n    throw new TypeError('\"size\" argument must be a number')\n  } else if (size < 0) {\n    throw new RangeError('\"size\" argument must not be negative')\n  }\n}\n\nfunction alloc (that, size, fill, encoding) {\n  assertSize(size)\n  if (size <= 0) {\n    return createBuffer(that, size)\n  }\n  if (fill !== undefined) {\n    // Only pay attention to encoding if it's a string. This\n    // prevents accidentally sending in a number that would\n    // be interpretted as a start offset.\n    return typeof encoding === 'string'\n      ? createBuffer(that, size).fill(fill, encoding)\n      : createBuffer(that, size).fill(fill)\n  }\n  return createBuffer(that, size)\n}\n\n/**\n * Creates a new filled Buffer instance.\n * alloc(size[, fill[, encoding]])\n **/\nBuffer.alloc = function (size, fill, encoding) {\n  return alloc(null, size, fill, encoding)\n}\n\nfunction allocUnsafe (that, size) {\n  assertSize(size)\n  that = createBuffer(that, size < 0 ? 0 : checked(size) | 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) {\n    for (var i = 0; i < size; ++i) {\n      that[i] = 0\n    }\n  }\n  return that\n}\n\n/**\n * Equivalent to Buffer(num), by default creates a non-zero-filled Buffer instance.\n * */\nBuffer.allocUnsafe = function (size) {\n  return allocUnsafe(null, size)\n}\n/**\n * Equivalent to SlowBuffer(num), by default creates a non-zero-filled Buffer instance.\n */\nBuffer.allocUnsafeSlow = function (size) {\n  return allocUnsafe(null, size)\n}\n\nfunction fromString (that, string, encoding) {\n  if (typeof encoding !== 'string' || encoding === '') {\n    encoding = 'utf8'\n  }\n\n  if (!Buffer.isEncoding(encoding)) {\n    throw new TypeError('\"encoding\" must be a valid string encoding')\n  }\n\n  var length = byteLength(string, encoding) | 0\n  that = createBuffer(that, length)\n\n  var actual = that.write(string, encoding)\n\n  if (actual !== length) {\n    // Writing a hex string, for example, that contains invalid characters will\n    // cause everything after the first invalid character to be ignored. (e.g.\n    // 'abxxcd' will be treated as 'ab')\n    that = that.slice(0, actual)\n  }\n\n  return that\n}\n\nfunction fromArrayLike (that, array) {\n  var length = array.length < 0 ? 0 : checked(array.length) | 0\n  that = createBuffer(that, length)\n  for (var i = 0; i < length; i += 1) {\n    that[i] = array[i] & 255\n  }\n  return that\n}\n\nfunction fromArrayBuffer (that, array, byteOffset, length) {\n  array.byteLength // this throws if `array` is not a valid ArrayBuffer\n\n  if (byteOffset < 0 || array.byteLength < byteOffset) {\n    throw new RangeError('\\'offset\\' is out of bounds')\n  }\n\n  if (array.byteLength < byteOffset + (length || 0)) {\n    throw new RangeError('\\'length\\' is out of bounds')\n  }\n\n  if (byteOffset === undefined && length === undefined) {\n    array = new Uint8Array(array)\n  } else if (length === undefined) {\n    array = new Uint8Array(array, byteOffset)\n  } else {\n    array = new Uint8Array(array, byteOffset, length)\n  }\n\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    // Return an augmented `Uint8Array` instance, for best performance\n    that = array\n    that.__proto__ = Buffer.prototype\n  } else {\n    // Fallback: Return an object instance of the Buffer class\n    that = fromArrayLike(that, array)\n  }\n  return that\n}\n\nfunction fromObject (that, obj) {\n  if (Buffer.isBuffer(obj)) {\n    var len = checked(obj.length) | 0\n    that = createBuffer(that, len)\n\n    if (that.length === 0) {\n      return that\n    }\n\n    obj.copy(that, 0, 0, len)\n    return that\n  }\n\n  if (obj) {\n    if ((typeof ArrayBuffer !== 'undefined' &&\n        obj.buffer instanceof ArrayBuffer) || 'length' in obj) {\n      if (typeof obj.length !== 'number' || isnan(obj.length)) {\n        return createBuffer(that, 0)\n      }\n      return fromArrayLike(that, obj)\n    }\n\n    if (obj.type === 'Buffer' && isArray(obj.data)) {\n      return fromArrayLike(that, obj.data)\n    }\n  }\n\n  throw new TypeError('First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.')\n}\n\nfunction checked (length) {\n  // Note: cannot use `length < kMaxLength()` here because that fails when\n  // length is NaN (which is otherwise coerced to zero.)\n  if (length >= kMaxLength()) {\n    throw new RangeError('Attempt to allocate Buffer larger than maximum ' +\n                         'size: 0x' + kMaxLength().toString(16) + ' bytes')\n  }\n  return length | 0\n}\n\nfunction SlowBuffer (length) {\n  if (+length != length) { // eslint-disable-line eqeqeq\n    length = 0\n  }\n  return Buffer.alloc(+length)\n}\n\nBuffer.isBuffer = function isBuffer (b) {\n  return !!(b != null && b._isBuffer)\n}\n\nBuffer.compare = function compare (a, b) {\n  if (!Buffer.isBuffer(a) || !Buffer.isBuffer(b)) {\n    throw new TypeError('Arguments must be Buffers')\n  }\n\n  if (a === b) return 0\n\n  var x = a.length\n  var y = b.length\n\n  for (var i = 0, len = Math.min(x, y); i < len; ++i) {\n    if (a[i] !== b[i]) {\n      x = a[i]\n      y = b[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\nBuffer.isEncoding = function isEncoding (encoding) {\n  switch (String(encoding).toLowerCase()) {\n    case 'hex':\n    case 'utf8':\n    case 'utf-8':\n    case 'ascii':\n    case 'latin1':\n    case 'binary':\n    case 'base64':\n    case 'ucs2':\n    case 'ucs-2':\n    case 'utf16le':\n    case 'utf-16le':\n      return true\n    default:\n      return false\n  }\n}\n\nBuffer.concat = function concat (list, length) {\n  if (!isArray(list)) {\n    throw new TypeError('\"list\" argument must be an Array of Buffers')\n  }\n\n  if (list.length === 0) {\n    return Buffer.alloc(0)\n  }\n\n  var i\n  if (length === undefined) {\n    length = 0\n    for (i = 0; i < list.length; ++i) {\n      length += list[i].length\n    }\n  }\n\n  var buffer = Buffer.allocUnsafe(length)\n  var pos = 0\n  for (i = 0; i < list.length; ++i) {\n    var buf = list[i]\n    if (!Buffer.isBuffer(buf)) {\n      throw new TypeError('\"list\" argument must be an Array of Buffers')\n    }\n    buf.copy(buffer, pos)\n    pos += buf.length\n  }\n  return buffer\n}\n\nfunction byteLength (string, encoding) {\n  if (Buffer.isBuffer(string)) {\n    return string.length\n  }\n  if (typeof ArrayBuffer !== 'undefined' && typeof ArrayBuffer.isView === 'function' &&\n      (ArrayBuffer.isView(string) || string instanceof ArrayBuffer)) {\n    return string.byteLength\n  }\n  if (typeof string !== 'string') {\n    string = '' + string\n  }\n\n  var len = string.length\n  if (len === 0) return 0\n\n  // Use a for loop to avoid recursion\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'ascii':\n      case 'latin1':\n      case 'binary':\n        return len\n      case 'utf8':\n      case 'utf-8':\n      case undefined:\n        return utf8ToBytes(string).length\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return len * 2\n      case 'hex':\n        return len >>> 1\n      case 'base64':\n        return base64ToBytes(string).length\n      default:\n        if (loweredCase) return utf8ToBytes(string).length // assume utf8\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\nBuffer.byteLength = byteLength\n\nfunction slowToString (encoding, start, end) {\n  var loweredCase = false\n\n  // No need to verify that \"this.length <= MAX_UINT32\" since it's a read-only\n  // property of a typed array.\n\n  // This behaves neither like String nor Uint8Array in that we set start/end\n  // to their upper/lower bounds if the value passed is out of range.\n  // undefined is handled specially as per ECMA-262 6th Edition,\n  // Section 13.3.3.7 Runtime Semantics: KeyedBindingInitialization.\n  if (start === undefined || start < 0) {\n    start = 0\n  }\n  // Return early if start > this.length. Done here to prevent potential uint32\n  // coercion fail below.\n  if (start > this.length) {\n    return ''\n  }\n\n  if (end === undefined || end > this.length) {\n    end = this.length\n  }\n\n  if (end <= 0) {\n    return ''\n  }\n\n  // Force coersion to uint32. This will also coerce falsey/NaN values to 0.\n  end >>>= 0\n  start >>>= 0\n\n  if (end <= start) {\n    return ''\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  while (true) {\n    switch (encoding) {\n      case 'hex':\n        return hexSlice(this, start, end)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Slice(this, start, end)\n\n      case 'ascii':\n        return asciiSlice(this, start, end)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Slice(this, start, end)\n\n      case 'base64':\n        return base64Slice(this, start, end)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return utf16leSlice(this, start, end)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = (encoding + '').toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\n// The property is used by `Buffer.isBuffer` and `is-buffer` (in Safari 5-7) to detect\n// Buffer instances.\nBuffer.prototype._isBuffer = true\n\nfunction swap (b, n, m) {\n  var i = b[n]\n  b[n] = b[m]\n  b[m] = i\n}\n\nBuffer.prototype.swap16 = function swap16 () {\n  var len = this.length\n  if (len % 2 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 16-bits')\n  }\n  for (var i = 0; i < len; i += 2) {\n    swap(this, i, i + 1)\n  }\n  return this\n}\n\nBuffer.prototype.swap32 = function swap32 () {\n  var len = this.length\n  if (len % 4 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 32-bits')\n  }\n  for (var i = 0; i < len; i += 4) {\n    swap(this, i, i + 3)\n    swap(this, i + 1, i + 2)\n  }\n  return this\n}\n\nBuffer.prototype.swap64 = function swap64 () {\n  var len = this.length\n  if (len % 8 !== 0) {\n    throw new RangeError('Buffer size must be a multiple of 64-bits')\n  }\n  for (var i = 0; i < len; i += 8) {\n    swap(this, i, i + 7)\n    swap(this, i + 1, i + 6)\n    swap(this, i + 2, i + 5)\n    swap(this, i + 3, i + 4)\n  }\n  return this\n}\n\nBuffer.prototype.toString = function toString () {\n  var length = this.length | 0\n  if (length === 0) return ''\n  if (arguments.length === 0) return utf8Slice(this, 0, length)\n  return slowToString.apply(this, arguments)\n}\n\nBuffer.prototype.equals = function equals (b) {\n  if (!Buffer.isBuffer(b)) throw new TypeError('Argument must be a Buffer')\n  if (this === b) return true\n  return Buffer.compare(this, b) === 0\n}\n\nBuffer.prototype.inspect = function inspect () {\n  var str = ''\n  var max = exports.INSPECT_MAX_BYTES\n  if (this.length > 0) {\n    str = this.toString('hex', 0, max).match(/.{2}/g).join(' ')\n    if (this.length > max) str += ' ... '\n  }\n  return '<Buffer ' + str + '>'\n}\n\nBuffer.prototype.compare = function compare (target, start, end, thisStart, thisEnd) {\n  if (!Buffer.isBuffer(target)) {\n    throw new TypeError('Argument must be a Buffer')\n  }\n\n  if (start === undefined) {\n    start = 0\n  }\n  if (end === undefined) {\n    end = target ? target.length : 0\n  }\n  if (thisStart === undefined) {\n    thisStart = 0\n  }\n  if (thisEnd === undefined) {\n    thisEnd = this.length\n  }\n\n  if (start < 0 || end > target.length || thisStart < 0 || thisEnd > this.length) {\n    throw new RangeError('out of range index')\n  }\n\n  if (thisStart >= thisEnd && start >= end) {\n    return 0\n  }\n  if (thisStart >= thisEnd) {\n    return -1\n  }\n  if (start >= end) {\n    return 1\n  }\n\n  start >>>= 0\n  end >>>= 0\n  thisStart >>>= 0\n  thisEnd >>>= 0\n\n  if (this === target) return 0\n\n  var x = thisEnd - thisStart\n  var y = end - start\n  var len = Math.min(x, y)\n\n  var thisCopy = this.slice(thisStart, thisEnd)\n  var targetCopy = target.slice(start, end)\n\n  for (var i = 0; i < len; ++i) {\n    if (thisCopy[i] !== targetCopy[i]) {\n      x = thisCopy[i]\n      y = targetCopy[i]\n      break\n    }\n  }\n\n  if (x < y) return -1\n  if (y < x) return 1\n  return 0\n}\n\n// Finds either the first index of `val` in `buffer` at offset >= `byteOffset`,\n// OR the last index of `val` in `buffer` at offset <= `byteOffset`.\n//\n// Arguments:\n// - buffer - a Buffer to search\n// - val - a string, Buffer, or number\n// - byteOffset - an index into `buffer`; will be clamped to an int32\n// - encoding - an optional encoding, relevant is val is a string\n// - dir - true for indexOf, false for lastIndexOf\nfunction bidirectionalIndexOf (buffer, val, byteOffset, encoding, dir) {\n  // Empty buffer means no match\n  if (buffer.length === 0) return -1\n\n  // Normalize byteOffset\n  if (typeof byteOffset === 'string') {\n    encoding = byteOffset\n    byteOffset = 0\n  } else if (byteOffset > 0x7fffffff) {\n    byteOffset = 0x7fffffff\n  } else if (byteOffset < -0x80000000) {\n    byteOffset = -0x80000000\n  }\n  byteOffset = +byteOffset  // Coerce to Number.\n  if (isNaN(byteOffset)) {\n    // byteOffset: it it's undefined, null, NaN, \"foo\", etc, search whole buffer\n    byteOffset = dir ? 0 : (buffer.length - 1)\n  }\n\n  // Normalize byteOffset: negative offsets start from the end of the buffer\n  if (byteOffset < 0) byteOffset = buffer.length + byteOffset\n  if (byteOffset >= buffer.length) {\n    if (dir) return -1\n    else byteOffset = buffer.length - 1\n  } else if (byteOffset < 0) {\n    if (dir) byteOffset = 0\n    else return -1\n  }\n\n  // Normalize val\n  if (typeof val === 'string') {\n    val = Buffer.from(val, encoding)\n  }\n\n  // Finally, search either indexOf (if dir is true) or lastIndexOf\n  if (Buffer.isBuffer(val)) {\n    // Special case: looking for empty string/buffer always fails\n    if (val.length === 0) {\n      return -1\n    }\n    return arrayIndexOf(buffer, val, byteOffset, encoding, dir)\n  } else if (typeof val === 'number') {\n    val = val & 0xFF // Search for a byte value [0-255]\n    if (Buffer.TYPED_ARRAY_SUPPORT &&\n        typeof Uint8Array.prototype.indexOf === 'function') {\n      if (dir) {\n        return Uint8Array.prototype.indexOf.call(buffer, val, byteOffset)\n      } else {\n        return Uint8Array.prototype.lastIndexOf.call(buffer, val, byteOffset)\n      }\n    }\n    return arrayIndexOf(buffer, [ val ], byteOffset, encoding, dir)\n  }\n\n  throw new TypeError('val must be string, number or Buffer')\n}\n\nfunction arrayIndexOf (arr, val, byteOffset, encoding, dir) {\n  var indexSize = 1\n  var arrLength = arr.length\n  var valLength = val.length\n\n  if (encoding !== undefined) {\n    encoding = String(encoding).toLowerCase()\n    if (encoding === 'ucs2' || encoding === 'ucs-2' ||\n        encoding === 'utf16le' || encoding === 'utf-16le') {\n      if (arr.length < 2 || val.length < 2) {\n        return -1\n      }\n      indexSize = 2\n      arrLength /= 2\n      valLength /= 2\n      byteOffset /= 2\n    }\n  }\n\n  function read (buf, i) {\n    if (indexSize === 1) {\n      return buf[i]\n    } else {\n      return buf.readUInt16BE(i * indexSize)\n    }\n  }\n\n  var i\n  if (dir) {\n    var foundIndex = -1\n    for (i = byteOffset; i < arrLength; i++) {\n      if (read(arr, i) === read(val, foundIndex === -1 ? 0 : i - foundIndex)) {\n        if (foundIndex === -1) foundIndex = i\n        if (i - foundIndex + 1 === valLength) return foundIndex * indexSize\n      } else {\n        if (foundIndex !== -1) i -= i - foundIndex\n        foundIndex = -1\n      }\n    }\n  } else {\n    if (byteOffset + valLength > arrLength) byteOffset = arrLength - valLength\n    for (i = byteOffset; i >= 0; i--) {\n      var found = true\n      for (var j = 0; j < valLength; j++) {\n        if (read(arr, i + j) !== read(val, j)) {\n          found = false\n          break\n        }\n      }\n      if (found) return i\n    }\n  }\n\n  return -1\n}\n\nBuffer.prototype.includes = function includes (val, byteOffset, encoding) {\n  return this.indexOf(val, byteOffset, encoding) !== -1\n}\n\nBuffer.prototype.indexOf = function indexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, true)\n}\n\nBuffer.prototype.lastIndexOf = function lastIndexOf (val, byteOffset, encoding) {\n  return bidirectionalIndexOf(this, val, byteOffset, encoding, false)\n}\n\nfunction hexWrite (buf, string, offset, length) {\n  offset = Number(offset) || 0\n  var remaining = buf.length - offset\n  if (!length) {\n    length = remaining\n  } else {\n    length = Number(length)\n    if (length > remaining) {\n      length = remaining\n    }\n  }\n\n  // must be an even number of digits\n  var strLen = string.length\n  if (strLen % 2 !== 0) throw new TypeError('Invalid hex string')\n\n  if (length > strLen / 2) {\n    length = strLen / 2\n  }\n  for (var i = 0; i < length; ++i) {\n    var parsed = parseInt(string.substr(i * 2, 2), 16)\n    if (isNaN(parsed)) return i\n    buf[offset + i] = parsed\n  }\n  return i\n}\n\nfunction utf8Write (buf, string, offset, length) {\n  return blitBuffer(utf8ToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nfunction asciiWrite (buf, string, offset, length) {\n  return blitBuffer(asciiToBytes(string), buf, offset, length)\n}\n\nfunction latin1Write (buf, string, offset, length) {\n  return asciiWrite(buf, string, offset, length)\n}\n\nfunction base64Write (buf, string, offset, length) {\n  return blitBuffer(base64ToBytes(string), buf, offset, length)\n}\n\nfunction ucs2Write (buf, string, offset, length) {\n  return blitBuffer(utf16leToBytes(string, buf.length - offset), buf, offset, length)\n}\n\nBuffer.prototype.write = function write (string, offset, length, encoding) {\n  // Buffer#write(string)\n  if (offset === undefined) {\n    encoding = 'utf8'\n    length = this.length\n    offset = 0\n  // Buffer#write(string, encoding)\n  } else if (length === undefined && typeof offset === 'string') {\n    encoding = offset\n    length = this.length\n    offset = 0\n  // Buffer#write(string, offset[, length][, encoding])\n  } else if (isFinite(offset)) {\n    offset = offset | 0\n    if (isFinite(length)) {\n      length = length | 0\n      if (encoding === undefined) encoding = 'utf8'\n    } else {\n      encoding = length\n      length = undefined\n    }\n  // legacy write(string, encoding, offset, length) - remove in v0.13\n  } else {\n    throw new Error(\n      'Buffer.write(string, encoding, offset[, length]) is no longer supported'\n    )\n  }\n\n  var remaining = this.length - offset\n  if (length === undefined || length > remaining) length = remaining\n\n  if ((string.length > 0 && (length < 0 || offset < 0)) || offset > this.length) {\n    throw new RangeError('Attempt to write outside buffer bounds')\n  }\n\n  if (!encoding) encoding = 'utf8'\n\n  var loweredCase = false\n  for (;;) {\n    switch (encoding) {\n      case 'hex':\n        return hexWrite(this, string, offset, length)\n\n      case 'utf8':\n      case 'utf-8':\n        return utf8Write(this, string, offset, length)\n\n      case 'ascii':\n        return asciiWrite(this, string, offset, length)\n\n      case 'latin1':\n      case 'binary':\n        return latin1Write(this, string, offset, length)\n\n      case 'base64':\n        // Warning: maxLength not taken into account in base64Write\n        return base64Write(this, string, offset, length)\n\n      case 'ucs2':\n      case 'ucs-2':\n      case 'utf16le':\n      case 'utf-16le':\n        return ucs2Write(this, string, offset, length)\n\n      default:\n        if (loweredCase) throw new TypeError('Unknown encoding: ' + encoding)\n        encoding = ('' + encoding).toLowerCase()\n        loweredCase = true\n    }\n  }\n}\n\nBuffer.prototype.toJSON = function toJSON () {\n  return {\n    type: 'Buffer',\n    data: Array.prototype.slice.call(this._arr || this, 0)\n  }\n}\n\nfunction base64Slice (buf, start, end) {\n  if (start === 0 && end === buf.length) {\n    return base64.fromByteArray(buf)\n  } else {\n    return base64.fromByteArray(buf.slice(start, end))\n  }\n}\n\nfunction utf8Slice (buf, start, end) {\n  end = Math.min(buf.length, end)\n  var res = []\n\n  var i = start\n  while (i < end) {\n    var firstByte = buf[i]\n    var codePoint = null\n    var bytesPerSequence = (firstByte > 0xEF) ? 4\n      : (firstByte > 0xDF) ? 3\n      : (firstByte > 0xBF) ? 2\n      : 1\n\n    if (i + bytesPerSequence <= end) {\n      var secondByte, thirdByte, fourthByte, tempCodePoint\n\n      switch (bytesPerSequence) {\n        case 1:\n          if (firstByte < 0x80) {\n            codePoint = firstByte\n          }\n          break\n        case 2:\n          secondByte = buf[i + 1]\n          if ((secondByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0x1F) << 0x6 | (secondByte & 0x3F)\n            if (tempCodePoint > 0x7F) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 3:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0xC | (secondByte & 0x3F) << 0x6 | (thirdByte & 0x3F)\n            if (tempCodePoint > 0x7FF && (tempCodePoint < 0xD800 || tempCodePoint > 0xDFFF)) {\n              codePoint = tempCodePoint\n            }\n          }\n          break\n        case 4:\n          secondByte = buf[i + 1]\n          thirdByte = buf[i + 2]\n          fourthByte = buf[i + 3]\n          if ((secondByte & 0xC0) === 0x80 && (thirdByte & 0xC0) === 0x80 && (fourthByte & 0xC0) === 0x80) {\n            tempCodePoint = (firstByte & 0xF) << 0x12 | (secondByte & 0x3F) << 0xC | (thirdByte & 0x3F) << 0x6 | (fourthByte & 0x3F)\n            if (tempCodePoint > 0xFFFF && tempCodePoint < 0x110000) {\n              codePoint = tempCodePoint\n            }\n          }\n      }\n    }\n\n    if (codePoint === null) {\n      // we did not generate a valid codePoint so insert a\n      // replacement char (U+FFFD) and advance only 1 byte\n      codePoint = 0xFFFD\n      bytesPerSequence = 1\n    } else if (codePoint > 0xFFFF) {\n      // encode to utf16 (surrogate pair dance)\n      codePoint -= 0x10000\n      res.push(codePoint >>> 10 & 0x3FF | 0xD800)\n      codePoint = 0xDC00 | codePoint & 0x3FF\n    }\n\n    res.push(codePoint)\n    i += bytesPerSequence\n  }\n\n  return decodeCodePointsArray(res)\n}\n\n// Based on http://stackoverflow.com/a/22747272/680742, the browser with\n// the lowest limit is Chrome, with 0x10000 args.\n// We go 1 magnitude less, for safety\nvar MAX_ARGUMENTS_LENGTH = 0x1000\n\nfunction decodeCodePointsArray (codePoints) {\n  var len = codePoints.length\n  if (len <= MAX_ARGUMENTS_LENGTH) {\n    return String.fromCharCode.apply(String, codePoints) // avoid extra slice()\n  }\n\n  // Decode in chunks to avoid \"call stack size exceeded\".\n  var res = ''\n  var i = 0\n  while (i < len) {\n    res += String.fromCharCode.apply(\n      String,\n      codePoints.slice(i, i += MAX_ARGUMENTS_LENGTH)\n    )\n  }\n  return res\n}\n\nfunction asciiSlice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i] & 0x7F)\n  }\n  return ret\n}\n\nfunction latin1Slice (buf, start, end) {\n  var ret = ''\n  end = Math.min(buf.length, end)\n\n  for (var i = start; i < end; ++i) {\n    ret += String.fromCharCode(buf[i])\n  }\n  return ret\n}\n\nfunction hexSlice (buf, start, end) {\n  var len = buf.length\n\n  if (!start || start < 0) start = 0\n  if (!end || end < 0 || end > len) end = len\n\n  var out = ''\n  for (var i = start; i < end; ++i) {\n    out += toHex(buf[i])\n  }\n  return out\n}\n\nfunction utf16leSlice (buf, start, end) {\n  var bytes = buf.slice(start, end)\n  var res = ''\n  for (var i = 0; i < bytes.length; i += 2) {\n    res += String.fromCharCode(bytes[i] + bytes[i + 1] * 256)\n  }\n  return res\n}\n\nBuffer.prototype.slice = function slice (start, end) {\n  var len = this.length\n  start = ~~start\n  end = end === undefined ? len : ~~end\n\n  if (start < 0) {\n    start += len\n    if (start < 0) start = 0\n  } else if (start > len) {\n    start = len\n  }\n\n  if (end < 0) {\n    end += len\n    if (end < 0) end = 0\n  } else if (end > len) {\n    end = len\n  }\n\n  if (end < start) end = start\n\n  var newBuf\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    newBuf = this.subarray(start, end)\n    newBuf.__proto__ = Buffer.prototype\n  } else {\n    var sliceLen = end - start\n    newBuf = new Buffer(sliceLen, undefined)\n    for (var i = 0; i < sliceLen; ++i) {\n      newBuf[i] = this[i + start]\n    }\n  }\n\n  return newBuf\n}\n\n/*\n * Need to make sure that buffer isn't trying to write out of bounds.\n */\nfunction checkOffset (offset, ext, length) {\n  if ((offset % 1) !== 0 || offset < 0) throw new RangeError('offset is not uint')\n  if (offset + ext > length) throw new RangeError('Trying to access beyond buffer length')\n}\n\nBuffer.prototype.readUIntLE = function readUIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUIntBE = function readUIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    checkOffset(offset, byteLength, this.length)\n  }\n\n  var val = this[offset + --byteLength]\n  var mul = 1\n  while (byteLength > 0 && (mul *= 0x100)) {\n    val += this[offset + --byteLength] * mul\n  }\n\n  return val\n}\n\nBuffer.prototype.readUInt8 = function readUInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  return this[offset]\n}\n\nBuffer.prototype.readUInt16LE = function readUInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return this[offset] | (this[offset + 1] << 8)\n}\n\nBuffer.prototype.readUInt16BE = function readUInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  return (this[offset] << 8) | this[offset + 1]\n}\n\nBuffer.prototype.readUInt32LE = function readUInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return ((this[offset]) |\n      (this[offset + 1] << 8) |\n      (this[offset + 2] << 16)) +\n      (this[offset + 3] * 0x1000000)\n}\n\nBuffer.prototype.readUInt32BE = function readUInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] * 0x1000000) +\n    ((this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    this[offset + 3])\n}\n\nBuffer.prototype.readIntLE = function readIntLE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var val = this[offset]\n  var mul = 1\n  var i = 0\n  while (++i < byteLength && (mul *= 0x100)) {\n    val += this[offset + i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readIntBE = function readIntBE (offset, byteLength, noAssert) {\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) checkOffset(offset, byteLength, this.length)\n\n  var i = byteLength\n  var mul = 1\n  var val = this[offset + --i]\n  while (i > 0 && (mul *= 0x100)) {\n    val += this[offset + --i] * mul\n  }\n  mul *= 0x80\n\n  if (val >= mul) val -= Math.pow(2, 8 * byteLength)\n\n  return val\n}\n\nBuffer.prototype.readInt8 = function readInt8 (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 1, this.length)\n  if (!(this[offset] & 0x80)) return (this[offset])\n  return ((0xff - this[offset] + 1) * -1)\n}\n\nBuffer.prototype.readInt16LE = function readInt16LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset] | (this[offset + 1] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt16BE = function readInt16BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 2, this.length)\n  var val = this[offset + 1] | (this[offset] << 8)\n  return (val & 0x8000) ? val | 0xFFFF0000 : val\n}\n\nBuffer.prototype.readInt32LE = function readInt32LE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset]) |\n    (this[offset + 1] << 8) |\n    (this[offset + 2] << 16) |\n    (this[offset + 3] << 24)\n}\n\nBuffer.prototype.readInt32BE = function readInt32BE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n\n  return (this[offset] << 24) |\n    (this[offset + 1] << 16) |\n    (this[offset + 2] << 8) |\n    (this[offset + 3])\n}\n\nBuffer.prototype.readFloatLE = function readFloatLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, true, 23, 4)\n}\n\nBuffer.prototype.readFloatBE = function readFloatBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 4, this.length)\n  return ieee754.read(this, offset, false, 23, 4)\n}\n\nBuffer.prototype.readDoubleLE = function readDoubleLE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, true, 52, 8)\n}\n\nBuffer.prototype.readDoubleBE = function readDoubleBE (offset, noAssert) {\n  if (!noAssert) checkOffset(offset, 8, this.length)\n  return ieee754.read(this, offset, false, 52, 8)\n}\n\nfunction checkInt (buf, value, offset, ext, max, min) {\n  if (!Buffer.isBuffer(buf)) throw new TypeError('\"buffer\" argument must be a Buffer instance')\n  if (value > max || value < min) throw new RangeError('\"value\" argument is out of bounds')\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n}\n\nBuffer.prototype.writeUIntLE = function writeUIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var mul = 1\n  var i = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUIntBE = function writeUIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  byteLength = byteLength | 0\n  if (!noAssert) {\n    var maxBytes = Math.pow(2, 8 * byteLength) - 1\n    checkInt(this, value, offset, byteLength, maxBytes, 0)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    this[offset + i] = (value / mul) & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeUInt8 = function writeUInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0xff, 0)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nfunction objectWriteUInt16 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 2); i < j; ++i) {\n    buf[offset + i] = (value & (0xff << (8 * (littleEndian ? i : 1 - i)))) >>>\n      (littleEndian ? i : 1 - i) * 8\n  }\n}\n\nBuffer.prototype.writeUInt16LE = function writeUInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeUInt16BE = function writeUInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0xffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nfunction objectWriteUInt32 (buf, value, offset, littleEndian) {\n  if (value < 0) value = 0xffffffff + value + 1\n  for (var i = 0, j = Math.min(buf.length - offset, 4); i < j; ++i) {\n    buf[offset + i] = (value >>> (littleEndian ? i : 3 - i) * 8) & 0xff\n  }\n}\n\nBuffer.prototype.writeUInt32LE = function writeUInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset + 3] = (value >>> 24)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 1] = (value >>> 8)\n    this[offset] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeUInt32BE = function writeUInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0xffffffff, 0)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeIntLE = function writeIntLE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = 0\n  var mul = 1\n  var sub = 0\n  this[offset] = value & 0xFF\n  while (++i < byteLength && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i - 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeIntBE = function writeIntBE (value, offset, byteLength, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) {\n    var limit = Math.pow(2, 8 * byteLength - 1)\n\n    checkInt(this, value, offset, byteLength, limit - 1, -limit)\n  }\n\n  var i = byteLength - 1\n  var mul = 1\n  var sub = 0\n  this[offset + i] = value & 0xFF\n  while (--i >= 0 && (mul *= 0x100)) {\n    if (value < 0 && sub === 0 && this[offset + i + 1] !== 0) {\n      sub = 1\n    }\n    this[offset + i] = ((value / mul) >> 0) - sub & 0xFF\n  }\n\n  return offset + byteLength\n}\n\nBuffer.prototype.writeInt8 = function writeInt8 (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 1, 0x7f, -0x80)\n  if (!Buffer.TYPED_ARRAY_SUPPORT) value = Math.floor(value)\n  if (value < 0) value = 0xff + value + 1\n  this[offset] = (value & 0xff)\n  return offset + 1\n}\n\nBuffer.prototype.writeInt16LE = function writeInt16LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n  } else {\n    objectWriteUInt16(this, value, offset, true)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt16BE = function writeInt16BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 2, 0x7fff, -0x8000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 8)\n    this[offset + 1] = (value & 0xff)\n  } else {\n    objectWriteUInt16(this, value, offset, false)\n  }\n  return offset + 2\n}\n\nBuffer.prototype.writeInt32LE = function writeInt32LE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value & 0xff)\n    this[offset + 1] = (value >>> 8)\n    this[offset + 2] = (value >>> 16)\n    this[offset + 3] = (value >>> 24)\n  } else {\n    objectWriteUInt32(this, value, offset, true)\n  }\n  return offset + 4\n}\n\nBuffer.prototype.writeInt32BE = function writeInt32BE (value, offset, noAssert) {\n  value = +value\n  offset = offset | 0\n  if (!noAssert) checkInt(this, value, offset, 4, 0x7fffffff, -0x80000000)\n  if (value < 0) value = 0xffffffff + value + 1\n  if (Buffer.TYPED_ARRAY_SUPPORT) {\n    this[offset] = (value >>> 24)\n    this[offset + 1] = (value >>> 16)\n    this[offset + 2] = (value >>> 8)\n    this[offset + 3] = (value & 0xff)\n  } else {\n    objectWriteUInt32(this, value, offset, false)\n  }\n  return offset + 4\n}\n\nfunction checkIEEE754 (buf, value, offset, ext, max, min) {\n  if (offset + ext > buf.length) throw new RangeError('Index out of range')\n  if (offset < 0) throw new RangeError('Index out of range')\n}\n\nfunction writeFloat (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 4, 3.4028234663852886e+38, -3.4028234663852886e+38)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 23, 4)\n  return offset + 4\n}\n\nBuffer.prototype.writeFloatLE = function writeFloatLE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeFloatBE = function writeFloatBE (value, offset, noAssert) {\n  return writeFloat(this, value, offset, false, noAssert)\n}\n\nfunction writeDouble (buf, value, offset, littleEndian, noAssert) {\n  if (!noAssert) {\n    checkIEEE754(buf, value, offset, 8, 1.7976931348623157E+308, -1.7976931348623157E+308)\n  }\n  ieee754.write(buf, value, offset, littleEndian, 52, 8)\n  return offset + 8\n}\n\nBuffer.prototype.writeDoubleLE = function writeDoubleLE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, true, noAssert)\n}\n\nBuffer.prototype.writeDoubleBE = function writeDoubleBE (value, offset, noAssert) {\n  return writeDouble(this, value, offset, false, noAssert)\n}\n\n// copy(targetBuffer, targetStart=0, sourceStart=0, sourceEnd=buffer.length)\nBuffer.prototype.copy = function copy (target, targetStart, start, end) {\n  if (!start) start = 0\n  if (!end && end !== 0) end = this.length\n  if (targetStart >= target.length) targetStart = target.length\n  if (!targetStart) targetStart = 0\n  if (end > 0 && end < start) end = start\n\n  // Copy 0 bytes; we're done\n  if (end === start) return 0\n  if (target.length === 0 || this.length === 0) return 0\n\n  // Fatal error conditions\n  if (targetStart < 0) {\n    throw new RangeError('targetStart out of bounds')\n  }\n  if (start < 0 || start >= this.length) throw new RangeError('sourceStart out of bounds')\n  if (end < 0) throw new RangeError('sourceEnd out of bounds')\n\n  // Are we oob?\n  if (end > this.length) end = this.length\n  if (target.length - targetStart < end - start) {\n    end = target.length - targetStart + start\n  }\n\n  var len = end - start\n  var i\n\n  if (this === target && start < targetStart && targetStart < end) {\n    // descending copy from end\n    for (i = len - 1; i >= 0; --i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else if (len < 1000 || !Buffer.TYPED_ARRAY_SUPPORT) {\n    // ascending copy from start\n    for (i = 0; i < len; ++i) {\n      target[i + targetStart] = this[i + start]\n    }\n  } else {\n    Uint8Array.prototype.set.call(\n      target,\n      this.subarray(start, start + len),\n      targetStart\n    )\n  }\n\n  return len\n}\n\n// Usage:\n//    buffer.fill(number[, offset[, end]])\n//    buffer.fill(buffer[, offset[, end]])\n//    buffer.fill(string[, offset[, end]][, encoding])\nBuffer.prototype.fill = function fill (val, start, end, encoding) {\n  // Handle string cases:\n  if (typeof val === 'string') {\n    if (typeof start === 'string') {\n      encoding = start\n      start = 0\n      end = this.length\n    } else if (typeof end === 'string') {\n      encoding = end\n      end = this.length\n    }\n    if (val.length === 1) {\n      var code = val.charCodeAt(0)\n      if (code < 256) {\n        val = code\n      }\n    }\n    if (encoding !== undefined && typeof encoding !== 'string') {\n      throw new TypeError('encoding must be a string')\n    }\n    if (typeof encoding === 'string' && !Buffer.isEncoding(encoding)) {\n      throw new TypeError('Unknown encoding: ' + encoding)\n    }\n  } else if (typeof val === 'number') {\n    val = val & 255\n  }\n\n  // Invalid ranges are not set to a default, so can range check early.\n  if (start < 0 || this.length < start || this.length < end) {\n    throw new RangeError('Out of range index')\n  }\n\n  if (end <= start) {\n    return this\n  }\n\n  start = start >>> 0\n  end = end === undefined ? this.length : end >>> 0\n\n  if (!val) val = 0\n\n  var i\n  if (typeof val === 'number') {\n    for (i = start; i < end; ++i) {\n      this[i] = val\n    }\n  } else {\n    var bytes = Buffer.isBuffer(val)\n      ? val\n      : utf8ToBytes(new Buffer(val, encoding).toString())\n    var len = bytes.length\n    for (i = 0; i < end - start; ++i) {\n      this[i + start] = bytes[i % len]\n    }\n  }\n\n  return this\n}\n\n// HELPER FUNCTIONS\n// ================\n\nvar INVALID_BASE64_RE = /[^+\\/0-9A-Za-z-_]/g\n\nfunction base64clean (str) {\n  // Node strips out invalid characters like \\n and \\t from the string, base64-js does not\n  str = stringtrim(str).replace(INVALID_BASE64_RE, '')\n  // Node converts strings with length < 2 to ''\n  if (str.length < 2) return ''\n  // Node allows for non-padded base64 strings (missing trailing ===), base64-js does not\n  while (str.length % 4 !== 0) {\n    str = str + '='\n  }\n  return str\n}\n\nfunction stringtrim (str) {\n  if (str.trim) return str.trim()\n  return str.replace(/^\\s+|\\s+$/g, '')\n}\n\nfunction toHex (n) {\n  if (n < 16) return '0' + n.toString(16)\n  return n.toString(16)\n}\n\nfunction utf8ToBytes (string, units) {\n  units = units || Infinity\n  var codePoint\n  var length = string.length\n  var leadSurrogate = null\n  var bytes = []\n\n  for (var i = 0; i < length; ++i) {\n    codePoint = string.charCodeAt(i)\n\n    // is surrogate component\n    if (codePoint > 0xD7FF && codePoint < 0xE000) {\n      // last char was a lead\n      if (!leadSurrogate) {\n        // no lead yet\n        if (codePoint > 0xDBFF) {\n          // unexpected trail\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        } else if (i + 1 === length) {\n          // unpaired lead\n          if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n          continue\n        }\n\n        // valid lead\n        leadSurrogate = codePoint\n\n        continue\n      }\n\n      // 2 leads in a row\n      if (codePoint < 0xDC00) {\n        if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n        leadSurrogate = codePoint\n        continue\n      }\n\n      // valid surrogate pair\n      codePoint = (leadSurrogate - 0xD800 << 10 | codePoint - 0xDC00) + 0x10000\n    } else if (leadSurrogate) {\n      // valid bmp char, but last char was a lead\n      if ((units -= 3) > -1) bytes.push(0xEF, 0xBF, 0xBD)\n    }\n\n    leadSurrogate = null\n\n    // encode utf8\n    if (codePoint < 0x80) {\n      if ((units -= 1) < 0) break\n      bytes.push(codePoint)\n    } else if (codePoint < 0x800) {\n      if ((units -= 2) < 0) break\n      bytes.push(\n        codePoint >> 0x6 | 0xC0,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x10000) {\n      if ((units -= 3) < 0) break\n      bytes.push(\n        codePoint >> 0xC | 0xE0,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else if (codePoint < 0x110000) {\n      if ((units -= 4) < 0) break\n      bytes.push(\n        codePoint >> 0x12 | 0xF0,\n        codePoint >> 0xC & 0x3F | 0x80,\n        codePoint >> 0x6 & 0x3F | 0x80,\n        codePoint & 0x3F | 0x80\n      )\n    } else {\n      throw new Error('Invalid code point')\n    }\n  }\n\n  return bytes\n}\n\nfunction asciiToBytes (str) {\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    // Node's code seems to be doing this and not & 0x7F..\n    byteArray.push(str.charCodeAt(i) & 0xFF)\n  }\n  return byteArray\n}\n\nfunction utf16leToBytes (str, units) {\n  var c, hi, lo\n  var byteArray = []\n  for (var i = 0; i < str.length; ++i) {\n    if ((units -= 2) < 0) break\n\n    c = str.charCodeAt(i)\n    hi = c >> 8\n    lo = c % 256\n    byteArray.push(lo)\n    byteArray.push(hi)\n  }\n\n  return byteArray\n}\n\nfunction base64ToBytes (str) {\n  return base64.toByteArray(base64clean(str))\n}\n\nfunction blitBuffer (src, dst, offset, length) {\n  for (var i = 0; i < length; ++i) {\n    if ((i + offset >= dst.length) || (i >= src.length)) break\n    dst[i + offset] = src[i]\n  }\n  return i\n}\n\nfunction isnan (val) {\n  return val !== val // eslint-disable-line no-self-compare\n}\n","module.exports = require(\"lodash.merge\");","import { LoginConfig, ObjectMultiplex, PostMessageStream, setupMultiplex, Substream, WhiteLabelData } from \"@toruslabs/openlogin-jrpc\";\n\nimport { modalDOMElementID } from \"./constants\";\nimport { documentReady, htmlToElement } from \"./utils\";\n\nexport const handleStream = (handle: Substream, eventName: string, handler: (chunk: any) => void): void => {\n  const handlerWrapper = (chunk) => {\n    handler(chunk);\n    handle.removeListener(eventName, handlerWrapper);\n  };\n  handle.on(eventName, handlerWrapper);\n};\n\nexport class Modal {\n  modalUrl: string;\n\n  iframeElem: HTMLIFrameElement;\n\n  initialized = false;\n\n  modalZIndex = 99999;\n\n  mux: ObjectMultiplex;\n\n  verifierStream: Substream;\n\n  constructor(modalUrl: string) {\n    this.modalUrl = modalUrl;\n  }\n\n  async init(): Promise<void> {\n    await this.initIFrame(this.modalUrl);\n    this.setupStream();\n  }\n\n  setupStream(): void {\n    if (this.iframeElem === null) throw new Error(\"iframe is null\");\n    this.mux = setupMultiplex(\n      new PostMessageStream({\n        name: \"modal_iframe_rpc\",\n        target: \"modal_rpc\",\n        targetWindow: this.iframeElem.contentWindow,\n        targetOrigin: new URL(this.modalUrl).origin,\n      })\n    );\n    this.verifierStream = this.mux.createStream(\"verifier\");\n  }\n\n  async initIFrame(src: string): Promise<void> {\n    await documentReady();\n    const documentIFrameElem = document.getElementById(modalDOMElementID) as HTMLIFrameElement;\n    if (documentIFrameElem) {\n      documentIFrameElem.remove();\n      window.console.log(\"already initialized, removing previous modal iframe\");\n    }\n    this.iframeElem = htmlToElement<HTMLIFrameElement>(\n      `<iframe\n        id=${modalDOMElementID}\n        class=\"torusIframe\"\n        src=\"${src}\"\n        style=\"display: none; position: fixed; top: 0; right: 0; width: 100%;\n        height: 100%; border: none; border-radius: 0; z-index: ${this.modalZIndex.toString()}\"\n      ></iframe>`\n    );\n    this._hideModal();\n    document.body.appendChild(this.iframeElem);\n    return new Promise<void>((resolve) => {\n      this.iframeElem.onload = () => {\n        this.initialized = true;\n        resolve();\n      };\n    });\n  }\n\n  _showModal(): void {\n    const style: Record<string, unknown> = {};\n    style.display = \"block\";\n    style.position = \"fixed\";\n    style.width = \"100%\";\n    style.height = \"100%\";\n    style.top = \"0px\";\n    style.right = \"0px\";\n    style.left = \"0px\";\n    style.bottom = \"0px\";\n    style.border = \"0\";\n    style[\"z-index\"] = this.modalZIndex;\n    this.iframeElem.setAttribute(\n      \"style\",\n      Object.entries(style)\n        .map(([k, v]) => `${k}:${v}`)\n        .join(\";\")\n    );\n  }\n\n  _hideModal(): void {\n    const style: Record<string, unknown> = {};\n    style.display = \"none\";\n    style.position = \"fixed\";\n    style.width = \"100%\";\n    style.height = \"100%\";\n    style.top = \"0px\";\n    style.right = \"0px\";\n    style.left = \"0px\";\n    style.bottom = \"0px\";\n    style.border = \"0\";\n    style[\"z-index\"] = this.modalZIndex;\n    this.iframeElem.setAttribute(\n      \"style\",\n      Object.entries(style)\n        .map(([k, v]) => `${k}:${v}`)\n        .join(\";\")\n    );\n  }\n\n  async _prompt(clientId: string, whiteLabel: WhiteLabelData, loginConfig: LoginConfig, cb: (chunk: any) => Promise<void>): Promise<void> {\n    this._showModal();\n    const modalHandler = (chunk) => {\n      this._hideModal();\n      cb(chunk);\n    };\n    handleStream(this.verifierStream, \"data\", modalHandler);\n    this.verifierStream.write({\n      name: \"prompt\",\n      clientId,\n      whiteLabel,\n      loginConfig,\n    });\n  }\n\n  async cleanup(): Promise<void> {\n    await documentReady();\n    const documentIFrameElem = document.getElementById(modalDOMElementID) as HTMLIFrameElement;\n    if (documentIFrameElem) {\n      documentIFrameElem.remove();\n      this.iframeElem = null;\n    }\n    this.initialized = false;\n  }\n}\n","module.exports = require(\"@babel/runtime/helpers/inherits\");","module.exports = require(\"@babel/runtime/helpers/possibleConstructorReturn\");","module.exports = require(\"pump\");","export * from \"./constants\";\nexport * from \"./IStore\";\nexport { default } from \"./OpenLogin\";\nexport * from \"./OpenLogin\";\nexport { default as OpenLoginStore } from \"./OpenLoginStore\";\nexport { default as Provider } from \"./Provider\";\nexport * from \"./utils\";\n","var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n","'use strict'\n\nexports.byteLength = byteLength\nexports.toByteArray = toByteArray\nexports.fromByteArray = fromByteArray\n\nvar lookup = []\nvar revLookup = []\nvar Arr = typeof Uint8Array !== 'undefined' ? Uint8Array : Array\n\nvar code = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/'\nfor (var i = 0, len = code.length; i < len; ++i) {\n  lookup[i] = code[i]\n  revLookup[code.charCodeAt(i)] = i\n}\n\n// Support decoding URL-safe base64 strings, as Node.js does.\n// See: https://en.wikipedia.org/wiki/Base64#URL_applications\nrevLookup['-'.charCodeAt(0)] = 62\nrevLookup['_'.charCodeAt(0)] = 63\n\nfunction getLens (b64) {\n  var len = b64.length\n\n  if (len % 4 > 0) {\n    throw new Error('Invalid string. Length must be a multiple of 4')\n  }\n\n  // Trim off extra bytes after placeholder bytes are found\n  // See: https://github.com/beatgammit/base64-js/issues/42\n  var validLen = b64.indexOf('=')\n  if (validLen === -1) validLen = len\n\n  var placeHoldersLen = validLen === len\n    ? 0\n    : 4 - (validLen % 4)\n\n  return [validLen, placeHoldersLen]\n}\n\n// base64 is 4/3 + up to two characters of the original data\nfunction byteLength (b64) {\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction _byteLength (b64, validLen, placeHoldersLen) {\n  return ((validLen + placeHoldersLen) * 3 / 4) - placeHoldersLen\n}\n\nfunction toByteArray (b64) {\n  var tmp\n  var lens = getLens(b64)\n  var validLen = lens[0]\n  var placeHoldersLen = lens[1]\n\n  var arr = new Arr(_byteLength(b64, validLen, placeHoldersLen))\n\n  var curByte = 0\n\n  // if there are placeholders, only get up to the last complete 4 chars\n  var len = placeHoldersLen > 0\n    ? validLen - 4\n    : validLen\n\n  var i\n  for (i = 0; i < len; i += 4) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 18) |\n      (revLookup[b64.charCodeAt(i + 1)] << 12) |\n      (revLookup[b64.charCodeAt(i + 2)] << 6) |\n      revLookup[b64.charCodeAt(i + 3)]\n    arr[curByte++] = (tmp >> 16) & 0xFF\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 2) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 2) |\n      (revLookup[b64.charCodeAt(i + 1)] >> 4)\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  if (placeHoldersLen === 1) {\n    tmp =\n      (revLookup[b64.charCodeAt(i)] << 10) |\n      (revLookup[b64.charCodeAt(i + 1)] << 4) |\n      (revLookup[b64.charCodeAt(i + 2)] >> 2)\n    arr[curByte++] = (tmp >> 8) & 0xFF\n    arr[curByte++] = tmp & 0xFF\n  }\n\n  return arr\n}\n\nfunction tripletToBase64 (num) {\n  return lookup[num >> 18 & 0x3F] +\n    lookup[num >> 12 & 0x3F] +\n    lookup[num >> 6 & 0x3F] +\n    lookup[num & 0x3F]\n}\n\nfunction encodeChunk (uint8, start, end) {\n  var tmp\n  var output = []\n  for (var i = start; i < end; i += 3) {\n    tmp =\n      ((uint8[i] << 16) & 0xFF0000) +\n      ((uint8[i + 1] << 8) & 0xFF00) +\n      (uint8[i + 2] & 0xFF)\n    output.push(tripletToBase64(tmp))\n  }\n  return output.join('')\n}\n\nfunction fromByteArray (uint8) {\n  var tmp\n  var len = uint8.length\n  var extraBytes = len % 3 // if we have 1 byte left, pad 2 bytes\n  var parts = []\n  var maxChunkLength = 16383 // must be multiple of 3\n\n  // go through the array every three bytes, we'll deal with trailing stuff later\n  for (var i = 0, len2 = len - extraBytes; i < len2; i += maxChunkLength) {\n    parts.push(encodeChunk(uint8, i, (i + maxChunkLength) > len2 ? len2 : (i + maxChunkLength)))\n  }\n\n  // pad the end with zeros, but make sure to not forget the extra bytes\n  if (extraBytes === 1) {\n    tmp = uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 2] +\n      lookup[(tmp << 4) & 0x3F] +\n      '=='\n    )\n  } else if (extraBytes === 2) {\n    tmp = (uint8[len - 2] << 8) + uint8[len - 1]\n    parts.push(\n      lookup[tmp >> 10] +\n      lookup[(tmp >> 4) & 0x3F] +\n      lookup[(tmp << 2) & 0x3F] +\n      '='\n    )\n  }\n\n  return parts.join('')\n}\n","/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */\nexports.read = function (buffer, offset, isLE, mLen, nBytes) {\n  var e, m\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var nBits = -7\n  var i = isLE ? (nBytes - 1) : 0\n  var d = isLE ? -1 : 1\n  var s = buffer[offset + i]\n\n  i += d\n\n  e = s & ((1 << (-nBits)) - 1)\n  s >>= (-nBits)\n  nBits += eLen\n  for (; nBits > 0; e = (e * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  m = e & ((1 << (-nBits)) - 1)\n  e >>= (-nBits)\n  nBits += mLen\n  for (; nBits > 0; m = (m * 256) + buffer[offset + i], i += d, nBits -= 8) {}\n\n  if (e === 0) {\n    e = 1 - eBias\n  } else if (e === eMax) {\n    return m ? NaN : ((s ? -1 : 1) * Infinity)\n  } else {\n    m = m + Math.pow(2, mLen)\n    e = e - eBias\n  }\n  return (s ? -1 : 1) * m * Math.pow(2, e - mLen)\n}\n\nexports.write = function (buffer, value, offset, isLE, mLen, nBytes) {\n  var e, m, c\n  var eLen = (nBytes * 8) - mLen - 1\n  var eMax = (1 << eLen) - 1\n  var eBias = eMax >> 1\n  var rt = (mLen === 23 ? Math.pow(2, -24) - Math.pow(2, -77) : 0)\n  var i = isLE ? 0 : (nBytes - 1)\n  var d = isLE ? 1 : -1\n  var s = value < 0 || (value === 0 && 1 / value < 0) ? 1 : 0\n\n  value = Math.abs(value)\n\n  if (isNaN(value) || value === Infinity) {\n    m = isNaN(value) ? 1 : 0\n    e = eMax\n  } else {\n    e = Math.floor(Math.log(value) / Math.LN2)\n    if (value * (c = Math.pow(2, -e)) < 1) {\n      e--\n      c *= 2\n    }\n    if (e + eBias >= 1) {\n      value += rt / c\n    } else {\n      value += rt * Math.pow(2, 1 - eBias)\n    }\n    if (value * c >= 2) {\n      e++\n      c /= 2\n    }\n\n    if (e + eBias >= eMax) {\n      m = 0\n      e = eMax\n    } else if (e + eBias >= 1) {\n      m = ((value * c) - 1) * Math.pow(2, mLen)\n      e = e + eBias\n    } else {\n      m = value * Math.pow(2, eBias - 1) * Math.pow(2, mLen)\n      e = 0\n    }\n  }\n\n  for (; mLen >= 8; buffer[offset + i] = m & 0xff, i += d, m /= 256, mLen -= 8) {}\n\n  e = (e << mLen) | m\n  eLen += mLen\n  for (; eLen > 0; buffer[offset + i] = e & 0xff, i += d, e /= 256, eLen -= 8) {}\n\n  buffer[offset + i - d] |= s * 128\n}\n","var toString = {}.toString;\n\nmodule.exports = Array.isArray || function (arr) {\n  return toString.call(arr) == '[object Array]';\n};\n"],"sourceRoot":""}